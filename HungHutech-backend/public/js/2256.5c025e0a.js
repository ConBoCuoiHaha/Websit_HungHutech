"use strict";(self["webpackChunkHungHutech"]=self["webpackChunkHungHutech"]||[]).push([[2256],{1114:function(e,t,a){function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function l(e,t){if("object"!=n(e)||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var l=a.call(e,t||"default");if("object"!=n(l))return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function o(e){var t=l(e,"string");return"symbol"==n(t)?t:t+""}function r(e,t,a){return(t=o(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}a.d(t,{A:function(){return r}})},1526:function(e,t,a){var n=a(1114),l=a(4335);const o=window?.appGlobal?.baseUrl&&`${window.appGlobal.baseUrl}/api`,r=o||"http://192.168.88.50:5000/api";console.log("API Base URL:",r);class i{constructor(){(0,n.A)(this,"axiosInstance",void 0),this.axiosInstance=l.A.create({baseURL:r,headers:{"Content-Type":"application/json"}}),this.axiosInstance.interceptors.request.use(e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e)),this.axiosInstance.interceptors.response.use(e=>e,e=>(401===e.response?.status&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login"),Promise.reject(e)))}get(e,t){return this.axiosInstance.get(e,t)}post(e,t,a){return this.axiosInstance.post(e,t,a)}put(e,t,a){return this.axiosInstance.put(e,t,a)}delete(e,t){return this.axiosInstance.delete(e,t)}patch(e,t,a){return this.axiosInstance.patch(e,t,a)}}t.A=new i},2256:function(e,t,a){a.r(t),a.d(t,{default:function(){return y}});var n=a(1431),l=a(8548),o=a(163),r=a(7918),i=a(5916),s=a(6604);const u={class:"orangehrm-department-page"},c={class:"orangehrm-page-header"},d={class:"orangehrm-page-actions"},h={class:"orangehrm-department-name"},p={key:0},g={key:1,class:"orangehrm-text-muted"};var m=(0,n.pM)({__name:"PhongBanList",setup(e){const t=(0,n.KR)([]),a=(0,n.KR)([]),m=(0,n.KR)(!1),_=(0,n.KR)(""),b=(0,n.KR)(!1),y=(0,n.KR)(!1),f=(0,n.KR)(),v=(0,n.KR)(""),w=(0,n.Kh)({ten:"",mo_ta:"",quan_ly_id:""}),k={ten:[{required:!0,message:"Vui lòng nhập tên phòng ban",trigger:"blur"}]},A=async()=>{m.value=!0,_.value="";try{const e=await i.A.getAll({limit:1e3});t.value=e.data||[]}catch(e){console.error("Error loading departments:",e),_.value=e.response?.data?.msg||"Không thể tải danh sách phòng ban",o.nk.error(_.value)}finally{m.value=!1}},R=async()=>{try{const e=await s.A.getAll({limit:1e3});a.value=e.data||[]}catch(e){console.error("Error loading employees:",e)}},S=e=>{v.value=e._id,w.ten=e.ten,w.mo_ta=e.mo_ta||"",w.quan_ly_id="string"===typeof e.quan_ly_id?e.quan_ly_id:e.quan_ly_id?._id||"",y.value=!0},F=async()=>{f.value&&await f.value.validate(async e=>{if(e){b.value=!0;try{v.value?(await i.A.update(v.value,w),o.nk.success("Cập nhật phòng ban thành công")):(await i.A.create(w),o.nk.success("Thêm phòng ban thành công")),x(),await A()}catch(t){console.error("Error saving department:",t),o.nk.error(t.response?.data?.msg||"Không thể lưu phòng ban")}finally{b.value=!1}}})},E=async e=>{try{await r.s.confirm("Bạn có chắc chắn muốn xóa phòng ban này?","Xác nhận xóa",{confirmButtonText:"Xóa",cancelButtonText:"Hủy",type:"warning"}),await i.A.delete(e),o.nk.success("Xóa phòng ban thành công"),await A()}catch(t){"cancel"!==t&&(console.error("Error deleting department:",t),o.nk.error(t.response?.data?.msg||"Không thể xóa phòng ban"))}},x=()=>{y.value=!1,v.value="",L()},L=()=>{f.value&&f.value.resetFields(),w.ten="",w.mo_ta="",w.quan_ly_id=""},B=e=>{if(!e)return"-";const t=new Date(e);return t.toLocaleDateString("vi-VN")};return(0,n.sV)(()=>{A(),R()}),(e,o)=>{const r=(0,n.g2)("el-button"),i=(0,n.g2)("el-table-column"),s=(0,n.g2)("el-space"),R=(0,n.g2)("el-table"),L=(0,n.g2)("el-card"),U=(0,n.g2)("el-input"),C=(0,n.g2)("el-form-item"),I=(0,n.g2)("el-option"),$=(0,n.g2)("el-select"),q=(0,n.g2)("el-form"),V=(0,n.g2)("el-dialog"),K=(0,n.gN)("loading");return(0,n.uX)(),(0,n.CE)("div",u,[(0,n.Lk)("div",c,[o[7]||(o[7]=(0,n.Lk)("h1",{class:"orangehrm-page-title"},"Phòng ban",-1)),(0,n.Lk)("div",d,[(0,n.bF)(r,{icon:(0,n.R1)(l.Refresh),onClick:A},{default:(0,n.k6)(()=>[...o[5]||(o[5]=[(0,n.eW)("Tải lại",-1)])]),_:1},8,["icon"]),(0,n.bF)(r,{type:"primary",icon:(0,n.R1)(l.Plus),onClick:o[0]||(o[0]=e=>y.value=!0)},{default:(0,n.k6)(()=>[...o[6]||(o[6]=[(0,n.eW)(" Thêm phòng ban ",-1)])]),_:1},8,["icon"])])]),(0,n.bF)(L,{class:"orangehrm-table-card",shadow:"never"},{default:(0,n.k6)(()=>[(0,n.bo)(((0,n.uX)(),(0,n.Wv)(R,{data:t.value,style:{width:"100%"},stripe:"","empty-text":_.value||"Không có dữ liệu"},{default:(0,n.k6)(()=>[(0,n.bF)(i,{prop:"ten",label:"Tên phòng ban","min-width":"250"},{default:(0,n.k6)(({row:e})=>[(0,n.Lk)("strong",h,(0,n.v_)(e.ten),1)]),_:1}),(0,n.bF)(i,{prop:"mo_ta",label:"Mô tả","min-width":"350"},{default:(0,n.k6)(({row:e})=>[(0,n.eW)((0,n.v_)(e.mo_ta||"-"),1)]),_:1}),(0,n.bF)(i,{label:"Quản lý","min-width":"200"},{default:(0,n.k6)(({row:e})=>[e.quan_ly_id?((0,n.uX)(),(0,n.CE)("span",p,(0,n.v_)(e.quan_ly_id.ho_dem)+" "+(0,n.v_)(e.quan_ly_id.ten),1)):((0,n.uX)(),(0,n.CE)("span",g,"Chưa có"))]),_:1}),(0,n.bF)(i,{label:"Ngày tạo",width:"150"},{default:(0,n.k6)(({row:e})=>[(0,n.eW)((0,n.v_)(B(e.ngay_tao)),1)]),_:1}),(0,n.bF)(i,{label:"Hành động",width:"150",fixed:"right"},{default:(0,n.k6)(({row:e})=>[(0,n.bF)(s,null,{default:(0,n.k6)(()=>[(0,n.bF)(r,{size:"small",icon:(0,n.R1)(l.Edit),onClick:t=>S(e)},{default:(0,n.k6)(()=>[...o[8]||(o[8]=[(0,n.eW)(" Sửa ",-1)])]),_:1},8,["icon","onClick"]),(0,n.bF)(r,{size:"small",type:"danger",icon:(0,n.R1)(l.Delete),onClick:t=>E(e._id)},{default:(0,n.k6)(()=>[...o[9]||(o[9]=[(0,n.eW)(" Xóa ",-1)])]),_:1},8,["icon","onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data","empty-text"])),[[K,m.value]])]),_:1}),(0,n.bF)(V,{modelValue:y.value,"onUpdate:modelValue":o[4]||(o[4]=e=>y.value=e),title:v.value?"Chỉnh sửa phòng ban":"Thêm phòng ban mới",width:"500px","close-on-click-modal":!1},{footer:(0,n.k6)(()=>[(0,n.bF)(r,{onClick:x},{default:(0,n.k6)(()=>[...o[10]||(o[10]=[(0,n.eW)("Hủy",-1)])]),_:1}),(0,n.bF)(r,{type:"primary",loading:b.value,onClick:F},{default:(0,n.k6)(()=>[...o[11]||(o[11]=[(0,n.eW)(" Lưu ",-1)])]),_:1},8,["loading"])]),default:(0,n.k6)(()=>[(0,n.bF)(q,{ref_key:"formRef",ref:f,model:w,rules:k,"label-width":"120px","label-position":"left"},{default:(0,n.k6)(()=>[(0,n.bF)(C,{label:"Tên phòng ban",prop:"ten",required:""},{default:(0,n.k6)(()=>[(0,n.bF)(U,{modelValue:w.ten,"onUpdate:modelValue":o[1]||(o[1]=e=>w.ten=e),placeholder:"Ví dụ: Phòng Nhân sự"},null,8,["modelValue"])]),_:1}),(0,n.bF)(C,{label:"Mô tả",prop:"mo_ta"},{default:(0,n.k6)(()=>[(0,n.bF)(U,{modelValue:w.mo_ta,"onUpdate:modelValue":o[2]||(o[2]=e=>w.mo_ta=e),type:"textarea",rows:4,placeholder:"Mô tả chi tiết về phòng ban này..."},null,8,["modelValue"])]),_:1}),(0,n.bF)(C,{label:"Quản lý",prop:"quan_ly_id"},{default:(0,n.k6)(()=>[(0,n.bF)($,{modelValue:w.quan_ly_id,"onUpdate:modelValue":o[3]||(o[3]=e=>w.quan_ly_id=e),placeholder:"Chọn quản lý phòng ban",filterable:"",clearable:"",style:{width:"100%"}},{default:(0,n.k6)(()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(a.value,e=>((0,n.uX)(),(0,n.Wv)(I,{key:e._id,label:`${e.ho_dem} ${e.ten} (${e.ma_nhan_vien})`,value:e._id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}}),_=a(6262);const b=(0,_.A)(m,[["__scopeId","data-v-56325576"]]);var y=b},5916:function(e,t,a){var n=a(1114),l=a(1526);class o{constructor(){(0,n.A)(this,"BASE_URL","/phongban")}async getAll(e){const t=await l.A.get(this.BASE_URL,{params:e});return t.data}async getById(e){const t=await l.A.get(`${this.BASE_URL}/${e}`);return t.data}async create(e){const t=await l.A.post(this.BASE_URL,e);return t.data}async update(e,t){const a=await l.A.put(`${this.BASE_URL}/${e}`,t);return a.data}async delete(e){await l.A.delete(`${this.BASE_URL}/${e}`)}}t.A=new o},6262:function(e,t){t.A=(e,t)=>{const a=e.__vccOpts||e;for(const[n,l]of t)a[n]=l;return a}},6604:function(e,t,a){var n=a(1114),l=a(1526);class o{constructor(){(0,n.A)(this,"BASE_URL","/nhanvien")}async getAll(e){const t=await l.A.get(this.BASE_URL,{params:e});return t.data}async getById(e){const t=await l.A.get(`${this.BASE_URL}/${e}`);return t.data}async create(e){const t=await l.A.post(this.BASE_URL,e);return t.data}async update(e,t){const a=await l.A.put(`${this.BASE_URL}/${e}`,t);return a.data}async delete(e){await l.A.delete(`${this.BASE_URL}/${e}`)}}t.A=new o}}]);
//# sourceMappingURL=2256.5c025e0a.js.map