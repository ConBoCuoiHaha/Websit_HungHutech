"use strict";(self["webpackChunkHungHutech"]=self["webpackChunkHungHutech"]||[]).push([[397],{1114:function(e,t,a){function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(e,t){if("object"!=n(e)||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var o=a.call(e,t||"default");if("object"!=n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function r(e){var t=o(e,"string");return"symbol"==n(t)?t:t+""}function l(e,t,a){return(t=r(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}a.d(t,{A:function(){return l}})},1526:function(e,t,a){var n=a(1114),o=a(4335);const r=window?.appGlobal?.baseUrl&&`${window.appGlobal.baseUrl}/api`,l=r||"http://192.168.88.50:5000/api";console.log("API Base URL:",l);class i{constructor(){(0,n.A)(this,"axiosInstance",void 0),this.axiosInstance=o.A.create({baseURL:l,headers:{"Content-Type":"application/json"}}),this.axiosInstance.interceptors.request.use(e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e)),this.axiosInstance.interceptors.response.use(e=>e,e=>(401===e.response?.status&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login"),Promise.reject(e)))}get(e,t){return this.axiosInstance.get(e,t)}post(e,t,a){return this.axiosInstance.post(e,t,a)}put(e,t,a){return this.axiosInstance.put(e,t,a)}delete(e,t){return this.axiosInstance.delete(e,t)}patch(e,t,a){return this.axiosInstance.patch(e,t,a)}}t.A=new i},2778:function(e,t,a){a.r(t),a.d(t,{default:function(){return _}});var n=a(1431),o=a(8548),r=a(163),l=a(7918),i=a(8733);const s={class:"orangehrm-kpi-page"},u={class:"orangehrm-page-header"},c={class:"orangehrm-page-actions"},g={class:"orangehrm-text-truncate"},d={class:"orangehrm-pagination"};var h=(0,n.pM)({__name:"KPIList",setup(e){const t=(0,n.KR)([]),a=(0,n.KR)(!1),h=(0,n.KR)(""),p=(0,n.KR)(!1),m=(0,n.KR)(!1),_=(0,n.KR)(""),b=(0,n.KR)(),f=(0,n.Kh)({currentPage:1,limit:10,total:0}),k=(0,n.Kh)({ten:"",mo_ta:"",trong_so:0,kich_hoat:!0}),v={ten:[{required:!0,message:"Vui lòng nhập tên KPI",trigger:"blur"}],trong_so:[{required:!0,message:"Vui lòng nhập trọng số",trigger:"blur"},{type:"number",min:0,max:100,message:"Trọng số phải từ 0 đến 100",trigger:"blur"}]},y=async()=>{a.value=!0,h.value="";try{const e={page:f.currentPage,limit:f.limit},a=await i.A.getAll(e);t.value=a.data||[],f.total=a.pagination?.total||0}catch(e){console.error("Error loading KPIs:",e),h.value=e.response?.data?.msg||"Không thể tải danh sách KPI",r.nk.error(h.value)}finally{a.value=!1}},w=e=>{f.currentPage=e,y()},I=e=>{f.limit=e,f.currentPage=1,y()},K=e=>{_.value=e._id,k.ten=e.ten,k.mo_ta=e.mo_ta||"",k.trong_so=e.trong_so,k.kich_hoat=e.kich_hoat,m.value=!0},P=async()=>{b.value&&await b.value.validate(async e=>{if(e){p.value=!0;try{const e={ten:k.ten,mo_ta:k.mo_ta,trong_so:k.trong_so,kich_hoat:k.kich_hoat};_.value?(await i.A.update(_.value,e),r.nk.success("Cập nhật KPI thành công")):(await i.A.create(e),r.nk.success("Tạo KPI thành công")),F(),await y()}catch(t){console.error("Error saving KPI:",t),r.nk.error(t.response?.data?.msg||"Không thể lưu KPI")}finally{p.value=!1}}})},x=async e=>{try{await l.s.confirm("Bạn có chắc chắn muốn xóa KPI này?","Xác nhận xóa",{confirmButtonText:"Xóa",cancelButtonText:"Hủy",type:"warning"}),await i.A.delete(e),r.nk.success("Xóa KPI thành công"),await y()}catch(t){"cancel"!==t&&(console.error("Error deleting KPI:",t),r.nk.error(t.response?.data?.msg||"Không thể xóa KPI"))}},F=()=>{m.value=!1,_.value="",b.value&&b.value.resetFields(),k.ten="",k.mo_ta="",k.trong_so=0,k.kich_hoat=!0},A=e=>{if(!e)return"-";const t=new Date(e);return t.toLocaleDateString("vi-VN")};return(0,n.sV)(()=>{y()}),(e,r)=>{const l=(0,n.g2)("el-button"),i=(0,n.g2)("el-table-column"),T=(0,n.g2)("el-tag"),R=(0,n.g2)("el-space"),S=(0,n.g2)("el-table"),V=(0,n.g2)("el-pagination"),C=(0,n.g2)("el-card"),L=(0,n.g2)("el-input"),U=(0,n.g2)("el-form-item"),B=(0,n.g2)("el-input-number"),E=(0,n.g2)("el-switch"),z=(0,n.g2)("el-form"),W=(0,n.g2)("el-dialog"),$=(0,n.gN)("loading");return(0,n.uX)(),(0,n.CE)("div",s,[(0,n.Lk)("div",u,[r[10]||(r[10]=(0,n.Lk)("h1",{class:"orangehrm-page-title"},"Quản lý KPI",-1)),(0,n.Lk)("div",c,[(0,n.bF)(l,{icon:(0,n.R1)(o.Refresh),onClick:y},{default:(0,n.k6)(()=>[...r[8]||(r[8]=[(0,n.eW)("Tải lại",-1)])]),_:1},8,["icon"]),(0,n.bF)(l,{type:"primary",icon:(0,n.R1)(o.Plus),onClick:r[0]||(r[0]=e=>m.value=!0)},{default:(0,n.k6)(()=>[...r[9]||(r[9]=[(0,n.eW)(" Thêm KPI ",-1)])]),_:1},8,["icon"])])]),(0,n.bF)(C,{class:"orangehrm-table-card",shadow:"never"},{default:(0,n.k6)(()=>[(0,n.bo)(((0,n.uX)(),(0,n.Wv)(S,{data:t.value,style:{width:"100%"},stripe:"","empty-text":h.value||"Không có dữ liệu"},{default:(0,n.k6)(()=>[(0,n.bF)(i,{type:"index",label:"STT",width:"60"}),(0,n.bF)(i,{prop:"ten",label:"Tên KPI","min-width":"250"},{default:(0,n.k6)(({row:e})=>[(0,n.Lk)("strong",null,(0,n.v_)(e.ten),1)]),_:1}),(0,n.bF)(i,{prop:"mo_ta",label:"Mô tả","min-width":"300"},{default:(0,n.k6)(({row:e})=>[(0,n.Lk)("div",g,(0,n.v_)(e.mo_ta||"-"),1)]),_:1}),(0,n.bF)(i,{prop:"trong_so",label:"Trọng số (%)",width:"130",align:"center"},{default:(0,n.k6)(({row:e})=>[(0,n.bF)(T,null,{default:(0,n.k6)(()=>[(0,n.eW)((0,n.v_)(e.trong_so)+"%",1)]),_:2},1024)]),_:1}),(0,n.bF)(i,{label:"Trạng thái",width:"120"},{default:(0,n.k6)(({row:e})=>[(0,n.bF)(T,{type:e.kich_hoat?"success":"info",size:"small"},{default:(0,n.k6)(()=>[(0,n.eW)((0,n.v_)(e.kich_hoat?"Kích hoạt":"Tạm dừng"),1)]),_:2},1032,["type"])]),_:1}),(0,n.bF)(i,{label:"Ngày tạo",width:"150"},{default:(0,n.k6)(({row:e})=>[(0,n.eW)((0,n.v_)(A(e.ngay_tao)),1)]),_:1}),(0,n.bF)(i,{label:"Hành động",width:"200",fixed:"right"},{default:(0,n.k6)(({row:e})=>[(0,n.bF)(R,null,{default:(0,n.k6)(()=>[(0,n.bF)(l,{size:"small",icon:(0,n.R1)(o.Edit),onClick:t=>K(e)},{default:(0,n.k6)(()=>[...r[11]||(r[11]=[(0,n.eW)("Sửa",-1)])]),_:1},8,["icon","onClick"]),(0,n.bF)(l,{size:"small",type:"danger",icon:(0,n.R1)(o.Delete),onClick:t=>x(e._id)},{default:(0,n.k6)(()=>[...r[12]||(r[12]=[(0,n.eW)(" Xóa ",-1)])]),_:1},8,["icon","onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data","empty-text"])),[[$,a.value]]),(0,n.Lk)("div",d,[(0,n.bF)(V,{"current-page":f.currentPage,"onUpdate:currentPage":r[1]||(r[1]=e=>f.currentPage=e),"page-size":f.limit,"onUpdate:pageSize":r[2]||(r[2]=e=>f.limit=e),"page-sizes":[10,20,50,100],total:f.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:I,onCurrentChange:w},null,8,["current-page","page-size","total"])])]),_:1}),(0,n.bF)(W,{modelValue:m.value,"onUpdate:modelValue":r[7]||(r[7]=e=>m.value=e),title:_.value?"Chỉnh sửa KPI":"Thêm KPI mới",width:"600px","close-on-click-modal":!1},{footer:(0,n.k6)(()=>[(0,n.bF)(l,{onClick:F},{default:(0,n.k6)(()=>[...r[14]||(r[14]=[(0,n.eW)("Hủy",-1)])]),_:1}),(0,n.bF)(l,{type:"primary",loading:p.value,onClick:P},{default:(0,n.k6)(()=>[(0,n.eW)((0,n.v_)(_.value?"Cập nhật":"Tạo mới"),1)]),_:1},8,["loading"])]),default:(0,n.k6)(()=>[(0,n.bF)(z,{ref_key:"formRef",ref:b,model:k,rules:v,"label-width":"120px","label-position":"left"},{default:(0,n.k6)(()=>[(0,n.bF)(U,{label:"Tên KPI",prop:"ten",required:""},{default:(0,n.k6)(()=>[(0,n.bF)(L,{modelValue:k.ten,"onUpdate:modelValue":r[3]||(r[3]=e=>k.ten=e),placeholder:"Nhập tên KPI...",maxlength:"200"},null,8,["modelValue"])]),_:1}),(0,n.bF)(U,{label:"Mô tả",prop:"mo_ta"},{default:(0,n.k6)(()=>[(0,n.bF)(L,{modelValue:k.mo_ta,"onUpdate:modelValue":r[4]||(r[4]=e=>k.mo_ta=e),type:"textarea",rows:4,placeholder:"Nhập mô tả KPI...",maxlength:"500","show-word-limit":""},null,8,["modelValue"])]),_:1}),(0,n.bF)(U,{label:"Trọng số (%)",prop:"trong_so",required:""},{default:(0,n.k6)(()=>[(0,n.bF)(B,{modelValue:k.trong_so,"onUpdate:modelValue":r[5]||(r[5]=e=>k.trong_so=e),min:0,max:100,precision:0,style:{width:"100%"}},null,8,["modelValue"]),r[13]||(r[13]=(0,n.Lk)("div",{class:"orangehrm-form-hint"}," Trọng số từ 0 đến 100%. Tổng trọng số các KPI nên bằng 100%. ",-1))]),_:1}),(0,n.bF)(U,{label:"Trạng thái",prop:"kich_hoat",required:""},{default:(0,n.k6)(()=>[(0,n.bF)(E,{modelValue:k.kich_hoat,"onUpdate:modelValue":r[6]||(r[6]=e=>k.kich_hoat=e),"active-text":"Kích hoạt","inactive-text":"Tạm dừng"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}}),p=a(6262);const m=(0,p.A)(h,[["__scopeId","data-v-0ea1803a"]]);var _=m},6262:function(e,t){t.A=(e,t)=>{const a=e.__vccOpts||e;for(const[n,o]of t)a[n]=o;return a}},8733:function(e,t,a){var n=a(1114),o=a(1526);class r{constructor(){(0,n.A)(this,"BASE_URL","/performance/kpis")}async getAll(e){const t=await o.A.get(this.BASE_URL,{params:e});return t.data}async getById(e){const t=await o.A.get(`${this.BASE_URL}/${e}`);return t.data}async create(e){const t=await o.A.post(this.BASE_URL,e);return t.data}async update(e,t){const a=await o.A.put(`${this.BASE_URL}/${e}`,t);return a.data}async delete(e){await o.A.delete(`${this.BASE_URL}/${e}`)}}t.A=new r}}]);
//# sourceMappingURL=397.cad1822a.js.map