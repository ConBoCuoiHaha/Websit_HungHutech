"use strict";(self["webpackChunkHungHutech"]=self["webpackChunkHungHutech"]||[]).push([[8824],{1114:function(e,t,a){function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(e,t){if("object"!=n(e)||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var o=a.call(e,t||"default");if("object"!=n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function r(e){var t=o(e,"string");return"symbol"==n(t)?t:t+""}function i(e,t,a){return(t=r(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}a.d(t,{A:function(){return i}})},1526:function(e,t,a){var n=a(1114),o=a(4335);const r=window?.appGlobal?.baseUrl&&`${window.appGlobal.baseUrl}/api`,i=r||"http://192.168.88.50:5000/api";console.log("API Base URL:",i);class l{constructor(){(0,n.A)(this,"axiosInstance",void 0),this.axiosInstance=o.A.create({baseURL:i,headers:{"Content-Type":"application/json"}}),this.axiosInstance.interceptors.request.use(e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e)),this.axiosInstance.interceptors.response.use(e=>e,e=>(401===e.response?.status&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login"),Promise.reject(e)))}get(e,t){return this.axiosInstance.get(e,t)}post(e,t,a){return this.axiosInstance.post(e,t,a)}put(e,t,a){return this.axiosInstance.put(e,t,a)}delete(e,t){return this.axiosInstance.delete(e,t)}patch(e,t,a){return this.axiosInstance.patch(e,t,a)}}t.A=new l},3439:function(e,t,a){var n=a(1114),o=a(1526);class r{constructor(){(0,n.A)(this,"BASE_URL","/reports")}async getAll(e){const t=await o.A.get(this.BASE_URL,{params:e});return t.data}async getById(e){const t=await o.A.get(`${this.BASE_URL}/${e}`);return t.data}async create(e){const t=await o.A.post(this.BASE_URL,e);return t.data}async update(e,t){const a=await o.A.put(`${this.BASE_URL}/${e}`,t);return a.data}async delete(e){await o.A.delete(`${this.BASE_URL}/${e}`)}async generate(e){const t=await o.A.post(`${this.BASE_URL}/generate`,e);return t.data}getExportUrl(e){const t=localStorage.getItem("token");return`http://localhost:5000/api${this.BASE_URL}/export/${e}?token=${t}`}downloadExport(e){const t=this.getExportUrl(e),a=document.createElement("a");a.href=t,a.download=`report-${e}.csv`,document.body.appendChild(a),a.click(),document.body.removeChild(a)}}t.A=new r},4114:function(e,t,a){var n=a(6518),o=a(8981),r=a(6198),i=a(4527),l=a(6837),c=a(9039),s=c(function(){return 4294967297!==[].push.call({length:4294967296},1)}),u=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(e){return e instanceof TypeError}},h=s||!u();n({target:"Array",proto:!0,arity:1,forced:h},{push:function(e){var t=o(this),a=r(t),n=arguments.length;l(a+n);for(var c=0;c<n;c++)t[a]=arguments[c],a++;return i(t,a),a}})},4376:function(e,t,a){var n=a(2195);e.exports=Array.isArray||function(e){return"Array"===n(e)}},4527:function(e,t,a){var n=a(3724),o=a(4376),r=TypeError,i=Object.getOwnPropertyDescriptor,l=n&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}();e.exports=l?function(e,t){if(o(e)&&!i(e,"length").writable)throw new r("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t}},6837:function(e){var t=TypeError,a=9007199254740991;e.exports=function(e){if(e>a)throw t("Maximum allowed index exceeded");return e}},8824:function(e,t,a){a.r(t),a.d(t,{default:function(){return m}});a(4114);var n=a(1431),o=a(5220),r=a(8548),i=a(163),l=a(7918),c=a(3439);const s={class:"report-list-page"},u={class:"page-header"},h={class:"page-actions"},p={class:"report-name"},d={class:"pagination"};var g=(0,n.pM)({__name:"ReportList",setup(e){const t=(0,o.rd)(),a=(0,n.KR)([]),g=(0,n.KR)(!1),b=(0,n.KR)(""),f=(0,n.KR)(""),m=(0,n.KR)(""),v=(0,n.Kh)({currentPage:1,limit:10,total:0}),y=async()=>{g.value=!0,b.value="";try{const e=await c.A.getAll({page:v.currentPage,limit:v.limit,q:f.value,loai_bao_cao:m.value||void 0});a.value=e.data||[],v.total=e.pagination?.total||0}catch(e){console.error("Error loading reports:",e),b.value=e.response?.data?.msg||"Không thể tải danh sách báo cáo",i.nk.error(b.value)}finally{g.value=!1}},_=()=>{v.currentPage=1,y()},w=e=>{v.currentPage=e,y()},k=e=>{v.limit=e,v.currentPage=1,y()},x=()=>{t.push("/bao-cao/tao-moi")},A=e=>{t.push(`/bao-cao/xem/${e}`)},F=e=>{t.push(`/bao-cao/chinh-sua/${e}`)},C=async e=>{try{i.nk.info("Đang xuất báo cáo..."),c.A.downloadExport(e),i.nk.success("Xuất báo cáo thành công")}catch(t){console.error("Error exporting report:",t),i.nk.error("Không thể xuất báo cáo")}},S=async e=>{try{await l.s.confirm("Bạn có chắc chắn muốn xóa báo cáo này?","Xác nhận xóa",{confirmButtonText:"Xóa",cancelButtonText:"Hủy",type:"warning"}),await c.A.delete(e),i.nk.success("Xóa báo cáo thành công"),await y()}catch(t){"cancel"!==t&&(console.error("Error deleting report:",t),i.nk.error(t.response?.data?.msg||"Không thể xóa báo cáo"))}},L=e=>{const t={"Nhan vien":"Nhân viên","Cham cong":"Chấm công","Nghi phep":"Nghỉ phép","Boi hoan":"Bồi hoàn",Luong:"Lương","Hieu suat":"Hiệu suất"};return t[e]||e},R=e=>{const t={"Nhan vien":"primary","Cham cong":"success","Nghi phep":"warning","Boi hoan":"danger",Luong:"info","Hieu suat":""};return t[e]||""},E=e=>e?"string"===typeof e?e:e.email||"-":"-",B=e=>e?new Date(e).toLocaleString("vi-VN"):"-";return(0,n.sV)(()=>{y()}),(e,t)=>{const o=(0,n.g2)("el-button"),i=(0,n.g2)("el-input"),l=(0,n.g2)("el-col"),c=(0,n.g2)("el-option"),P=(0,n.g2)("el-select"),U=(0,n.g2)("el-row"),I=(0,n.g2)("el-card"),N=(0,n.g2)("el-table-column"),$=(0,n.g2)("el-tag"),T=(0,n.g2)("el-space"),W=(0,n.g2)("el-table"),z=(0,n.g2)("el-pagination"),H=(0,n.gN)("loading");return(0,n.uX)(),(0,n.CE)("div",s,[(0,n.Lk)("div",u,[t[6]||(t[6]=(0,n.Lk)("h1",{class:"page-title"},"Quản lý Báo cáo",-1)),(0,n.Lk)("div",h,[(0,n.bF)(o,{icon:(0,n.R1)(r.Refresh),onClick:y},{default:(0,n.k6)(()=>[...t[4]||(t[4]=[(0,n.eW)("Tải lại",-1)])]),_:1},8,["icon"]),(0,n.bF)(o,{type:"primary",icon:(0,n.R1)(r.Plus),onClick:x},{default:(0,n.k6)(()=>[...t[5]||(t[5]=[(0,n.eW)(" Tạo báo cáo mới ",-1)])]),_:1},8,["icon"])])]),(0,n.bF)(I,{class:"filter-card",shadow:"never"},{default:(0,n.k6)(()=>[(0,n.bF)(U,{gutter:16},{default:(0,n.k6)(()=>[(0,n.bF)(l,{xs:24,sm:12,md:8},{default:(0,n.k6)(()=>[(0,n.bF)(i,{modelValue:f.value,"onUpdate:modelValue":t[0]||(t[0]=e=>f.value=e),placeholder:"Tìm kiếm theo tên báo cáo...","prefix-icon":(0,n.R1)(r.Search),clearable:"",onInput:_},null,8,["modelValue","prefix-icon"])]),_:1}),(0,n.bF)(l,{xs:24,sm:12,md:8},{default:(0,n.k6)(()=>[(0,n.bF)(P,{modelValue:m.value,"onUpdate:modelValue":t[1]||(t[1]=e=>m.value=e),placeholder:"Lọc theo loại báo cáo",clearable:"",style:{width:"100%"},onChange:_},{default:(0,n.k6)(()=>[(0,n.bF)(c,{label:"Tất cả loại",value:""}),(0,n.bF)(c,{label:"Nhân viên",value:"Nhan vien"}),(0,n.bF)(c,{label:"Chấm công",value:"Cham cong"}),(0,n.bF)(c,{label:"Nghỉ phép",value:"Nghi phep"}),(0,n.bF)(c,{label:"Bồi hoàn",value:"Boi hoan"}),(0,n.bF)(c,{label:"Lương",value:"Luong"}),(0,n.bF)(c,{label:"Hiệu suất",value:"Hieu suat"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),(0,n.bF)(I,{class:"table-card",shadow:"never"},{default:(0,n.k6)(()=>[(0,n.bo)(((0,n.uX)(),(0,n.Wv)(W,{data:a.value,style:{width:"100%"},stripe:"","empty-text":b.value||"Không có báo cáo nào"},{default:(0,n.k6)(()=>[(0,n.bF)(N,{prop:"ten_bao_cao",label:"Tên báo cáo","min-width":"200"},{default:(0,n.k6)(({row:e})=>[(0,n.Lk)("strong",p,(0,n.v_)(e.ten_bao_cao),1)]),_:1}),(0,n.bF)(N,{label:"Loại báo cáo","min-width":"150"},{default:(0,n.k6)(({row:e})=>[(0,n.bF)($,{type:R(e.loai_bao_cao)},{default:(0,n.k6)(()=>[(0,n.eW)((0,n.v_)(L(e.loai_bao_cao)),1)]),_:2},1032,["type"])]),_:1}),(0,n.bF)(N,{label:"Số tiêu chí",width:"120",align:"center"},{default:(0,n.k6)(({row:e})=>[(0,n.eW)((0,n.v_)(e.tieu_chi?.length||0),1)]),_:1}),(0,n.bF)(N,{label:"Số cột",width:"100",align:"center"},{default:(0,n.k6)(({row:e})=>[(0,n.eW)((0,n.v_)(e.cot_hien_thi?.length||0),1)]),_:1}),(0,n.bF)(N,{label:"Người tạo","min-width":"150"},{default:(0,n.k6)(({row:e})=>[(0,n.eW)((0,n.v_)(E(e.nguoi_tao_id)),1)]),_:1}),(0,n.bF)(N,{label:"Ngày cập nhật","min-width":"150"},{default:(0,n.k6)(({row:e})=>[(0,n.eW)((0,n.v_)(B(e.ngay_cap_nhat)),1)]),_:1}),(0,n.bF)(N,{label:"Hành động",width:"280",fixed:"right"},{default:(0,n.k6)(({row:e})=>[(0,n.bF)(T,null,{default:(0,n.k6)(()=>[(0,n.bF)(o,{size:"small",icon:(0,n.R1)(r.View),onClick:t=>A(e._id)},{default:(0,n.k6)(()=>[...t[7]||(t[7]=[(0,n.eW)(" Xem ",-1)])]),_:1},8,["icon","onClick"]),(0,n.bF)(o,{size:"small",type:"primary",icon:(0,n.R1)(r.Edit),onClick:t=>F(e._id)},{default:(0,n.k6)(()=>[...t[8]||(t[8]=[(0,n.eW)(" Sửa ",-1)])]),_:1},8,["icon","onClick"]),(0,n.bF)(o,{size:"small",type:"success",icon:(0,n.R1)(r.Download),onClick:t=>C(e._id)},{default:(0,n.k6)(()=>[...t[9]||(t[9]=[(0,n.eW)(" Xuất ",-1)])]),_:1},8,["icon","onClick"]),(0,n.bF)(o,{size:"small",type:"danger",icon:(0,n.R1)(r.Delete),onClick:t=>S(e._id)},{default:(0,n.k6)(()=>[...t[10]||(t[10]=[(0,n.eW)(" Xóa ",-1)])]),_:1},8,["icon","onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data","empty-text"])),[[H,g.value]]),(0,n.Lk)("div",d,[(0,n.bF)(z,{"current-page":v.currentPage,"onUpdate:currentPage":t[2]||(t[2]=e=>v.currentPage=e),"page-size":v.limit,"onUpdate:pageSize":t[3]||(t[3]=e=>v.limit=e),"page-sizes":[10,20,50,100],total:v.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:k,onCurrentChange:w},null,8,["current-page","page-size","total"])])]),_:1})])}}}),b=a(6262);const f=(0,b.A)(g,[["__scopeId","data-v-a457396e"]]);var m=f}}]);
//# sourceMappingURL=8824.e6d7f9c0.js.map