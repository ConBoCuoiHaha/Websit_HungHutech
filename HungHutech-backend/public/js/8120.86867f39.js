"use strict";(self["webpackChunkHungHutech"]=self["webpackChunkHungHutech"]||[]).push([[8120],{116:function(e,t,n){var a=n(6518),r=n(9565),o=n(2652),i=n(9306),l=n(8551),u=n(1767),c=n(9539),s=n(4549),h=s("find",TypeError);a({target:"Iterator",proto:!0,real:!0,forced:h},{find:function(e){l(this);try{i(e)}catch(a){c(this,"throw",a)}if(h)return r(h,this,e);var t=u(this),n=0;return o(t,function(t,a){if(e(t,n++))return a(t)},{IS_RECORD:!0,INTERRUPTED:!0}).result}})},684:function(e){e.exports=function(e,t){var n="function"==typeof Iterator&&Iterator.prototype[e];if(n)try{n.call({next:null},t).next()}catch(a){return!0}}},1385:function(e,t,n){var a=n(9539);e.exports=function(e,t,n){for(var r=e.length-1;r>=0;r--)if(void 0!==e[r])try{n=a(e[r].iterator,t,n)}catch(o){t="throw",n=o}if("throw"===t)throw n;return n}},1526:function(e,t,n){var a=n(1114),r=n(4335);const o=window?.appGlobal?.baseUrl&&`${window.appGlobal.baseUrl}/api`,i=o||"http://192.168.88.50:5000/api";console.log("API Base URL:",i);class l{constructor(){(0,a.A)(this,"axiosInstance",void 0),this.axiosInstance=r.A.create({baseURL:i,headers:{"Content-Type":"application/json"}}),this.axiosInstance.interceptors.request.use(e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e)),this.axiosInstance.interceptors.response.use(e=>e,e=>(401===e.response?.status&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login"),Promise.reject(e)))}get(e,t){return this.axiosInstance.get(e,t)}post(e,t,n){return this.axiosInstance.post(e,t,n)}put(e,t,n){return this.axiosInstance.put(e,t,n)}delete(e,t){return this.axiosInstance.delete(e,t)}patch(e,t,n){return this.axiosInstance.patch(e,t,n)}}t.A=new l},2489:function(e,t,n){var a=n(6518),r=n(9565),o=n(9306),i=n(8551),l=n(1767),u=n(9462),c=n(6319),s=n(6395),h=n(9539),g=n(684),d=n(4549),v=!s&&!g("filter",function(){}),p=!s&&!v&&d("filter",TypeError),_=s||v||p,f=u(function(){var e,t,n,a=this.iterator,o=this.predicate,l=this.next;while(1){if(e=i(r(l,a)),t=this.done=!!e.done,t)return;if(n=e.value,c(a,o,[n,this.counter++],!0))return n}});a({target:"Iterator",proto:!0,real:!0,forced:_},{filter:function(e){i(this);try{o(e)}catch(t){h(this,"throw",t)}return p?r(p,this,e):new f(l(this),{predicate:e})}})},2529:function(e){e.exports=function(e,t){return{value:e,done:t}}},3439:function(e,t,n){var a=n(1114),r=n(1526);class o{constructor(){(0,a.A)(this,"BASE_URL","/reports")}async getAll(e){const t=await r.A.get(this.BASE_URL,{params:e});return t.data}async getById(e){const t=await r.A.get(`${this.BASE_URL}/${e}`);return t.data}async create(e){const t=await r.A.post(this.BASE_URL,e);return t.data}async update(e,t){const n=await r.A.put(`${this.BASE_URL}/${e}`,t);return n.data}async delete(e){await r.A.delete(`${this.BASE_URL}/${e}`)}async generate(e){const t=await r.A.post(`${this.BASE_URL}/generate`,e);return t.data}getExportUrl(e){const t=localStorage.getItem("token");return`http://localhost:5000/api${this.BASE_URL}/export/${e}?token=${t}`}downloadExport(e){const t=this.getExportUrl(e),n=document.createElement("a");n.href=t,n.download=`report-${e}.csv`,document.body.appendChild(n),n.click(),document.body.removeChild(n)}}t.A=new o},3579:function(e,t,n){var a=n(6518),r=n(9565),o=n(2652),i=n(9306),l=n(8551),u=n(1767),c=n(9539),s=n(4549),h=s("some",TypeError);a({target:"Iterator",proto:!0,real:!0,forced:h},{some:function(e){l(this);try{i(e)}catch(a){c(this,"throw",a)}if(h)return r(h,this,e);var t=u(this),n=0;return o(t,function(t,a){if(e(t,n++))return a()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})},4114:function(e,t,n){var a=n(6518),r=n(8981),o=n(6198),i=n(4527),l=n(6837),u=n(9039),c=u(function(){return 4294967297!==[].push.call({length:4294967296},1)}),s=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(e){return e instanceof TypeError}},h=c||!s();a({target:"Array",proto:!0,arity:1,forced:h},{push:function(e){var t=r(this),n=o(t),a=arguments.length;l(n+a);for(var u=0;u<a;u++)t[n]=arguments[u],n++;return i(t,n),n}})},4376:function(e,t,n){var a=n(2195);e.exports=Array.isArray||function(e){return"Array"===a(e)}},4527:function(e,t,n){var a=n(3724),r=n(4376),o=TypeError,i=Object.getOwnPropertyDescriptor,l=a&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}();e.exports=l?function(e,t){if(r(e)&&!i(e,"length").writable)throw new o("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t}},6279:function(e,t,n){var a=n(6840);e.exports=function(e,t,n){for(var r in t)a(e,r,t[r],n);return e}},6319:function(e,t,n){var a=n(8551),r=n(9539);e.exports=function(e,t,n,o){try{return o?t(a(n)[0],n[1]):t(n)}catch(i){r(e,"throw",i)}}},6837:function(e){var t=TypeError,n=9007199254740991;e.exports=function(e){if(e>n)throw t("Maximum allowed index exceeded");return e}},8120:function(e,t,n){n.r(t),n.d(t,{default:function(){return m}});n(4114),n(8111),n(2489),n(116),n(8237),n(3579);var a=n(1431),r=n(5220),o=n(8548),i=n(163),l=n(3439);const u={class:"report-view-page"},c={class:"page-header"},s={class:"header-left"},h={class:"report-info"},g={class:"page-title"},d={class:"page-actions"},v={key:0,class:"applied-criteria"},p={class:"criteria-tags"},_={class:"pagination"};var f=(0,a.pM)({__name:"ReportView",setup(e){const t=(0,r.rd)(),n=(0,r.lq)(),f=(0,a.KR)(null),b=(0,a.KR)([]),y=(0,a.KR)(!1),m=(0,a.KR)(""),w=(0,a.KR)(""),x=(0,a.Kh)({currentPage:1,limit:20,total:0}),k=(0,a.EW)(()=>{if(f.value?.sap_xep?.truong)return{prop:f.value.sap_xep.truong,order:"desc"===f.value.sap_xep.thu_tu?"descending":"ascending"}}),E=(0,a.EW)(()=>f.value&&f.value.cot_hien_thi||[]),I=(0,a.EW)(()=>{if(!w.value)return b.value;const e=w.value.toLowerCase();return b.value.filter(t=>Object.values(t).some(t=>null!==t&&void 0!==t&&String(t).toLowerCase().includes(e)))}),R={"Nhan vien":[{label:"Mã nhân viên",value:"ma_nhan_vien"},{label:"Họ đệm",value:"ho_dem"},{label:"Tên",value:"ten"},{label:"Email",value:"lien_he.email_cong_viec"},{label:"Ngày sinh",value:"ngay_sinh"},{label:"Giới tính",value:"gioi_tinh"},{label:"Phòng ban",value:"thong_tin_cong_viec.phong_ban_id"},{label:"Chức danh",value:"thong_tin_cong_viec.chuc_danh_id"},{label:"Ngày vào làm",value:"thong_tin_cong_viec.ngay_vao_lam"},{label:"Trạng thái lao động",value:"thong_tin_cong_viec.trang_thai_lao_dong_id"}],"Cham cong":[{label:"Nhân viên",value:"nhan_vien_id"},{label:"Ngày",value:"ngay"},{label:"Thời gian vào",value:"thoi_gian_vao"},{label:"Thời gian ra",value:"thoi_gian_ra"},{label:"Ghi chú",value:"ghi_chu"}],"Nghi phep":[{label:"Nhân viên",value:"nhan_vien_id"},{label:"Loại ngày nghỉ",value:"loai_ngay_nghi_id"},{label:"Ngày bắt đầu",value:"ngay_bat_dau"},{label:"Ngày kết thúc",value:"ngay_ket_thuc"},{label:"Số ngày",value:"so_ngay"},{label:"Trạng thái",value:"trang_thai"},{label:"Lý do",value:"ly_do"}],"Boi hoan":[{label:"Nhân viên",value:"nhan_vien_id"},{label:"Trạng thái",value:"trang_thai"},{label:"Tổng tiền",value:"tong_tien"},{label:"Ngày tạo",value:"ngay_tao"}],Luong:[{label:"Nhân viên",value:"nhan_vien_id"},{label:"Tháng",value:"thang"},{label:"Lương cơ bản",value:"luong_co_ban"},{label:"Phụ cấp",value:"phu_cap"},{label:"Thưởng",value:"thuong"},{label:"Khấu trừ",value:"khau_tru"},{label:"Thực lãnh",value:"thuc_lanh"}],"Hieu suat":[{label:"Nhân viên",value:"nhan_vien_id"},{label:"Người đánh giá",value:"nguoi_danh_gia_id"},{label:"Từ ngày",value:"tu_ngay"},{label:"Đến ngày",value:"den_ngay"},{label:"Điểm tổng",value:"diem_tong"},{label:"Trạng thái",value:"trang_thai"}]},A=async()=>{try{f.value=await l.A.getById(n.params.id)}catch(e){console.error("Error loading report config:",e),i.nk.error("Không thể tải cấu hình báo cáo"),t.push("/bao-cao")}},C=async()=>{if(f.value){y.value=!0,m.value="";try{const e=await l.A.generate({loai_bao_cao:f.value.loai_bao_cao,tieu_chi:f.value.tieu_chi,cot_hien_thi:f.value.cot_hien_thi,sap_xep:f.value.sap_xep,page:x.currentPage,limit:x.limit});b.value=e.data,x.total=e.pagination?.total}catch(e){console.error("Error loading report data:",e),m.value=e.response?.data?.msg||"Không thể tải dữ liệu báo cáo",i.nk.error(m.value)}finally{y.value=!1}}},T=()=>{t.push("/bao-cao")},L=()=>{C()},S=()=>{window.print()},N=()=>{f.value&&(i.nk.info("Đang xuất báo cáo..."),l.A.downloadExport(f.value._id),i.nk.success("Xuất báo cáo thành công"))},P=()=>{},U=e=>{x.currentPage=e,C()},F=e=>{x.limit=e,x.currentPage=1,C()},B=({prop:e,order:t})=>{f.value&&(f.value.sap_xep=t?{truong:e,thu_tu:"descending"===t?"desc":"asc"}:{truong:"",thu_tu:"asc"},C())},W=e=>{if(!f.value)return e;const t=R[f.value.loai_bao_cao]||[],n=t.find(t=>t.value===e);return n?n.label:e},$=(e,t)=>t.split(".").reduce((e,t)=>e?.[t],e),H=e=>null===e||void 0===e?"-":"object"===typeof e?e.ten?e.ten:e.ten_chuc_danh?e.ten_chuc_danh:e.ho_dem&&e.ten?`${e.ho_dem} ${e.ten}`:e.$numberDecimal?e.$numberDecimal:JSON.stringify(e):"boolean"===typeof e?e?"Có":"Không":"number"===typeof e?e.toLocaleString("vi-VN"):"string"===typeof e&&e.match(/^\d{4}-\d{2}-\d{2}/)?new Date(e).toLocaleDateString("vi-VN"):String(e),K=e=>{const t={"Nhan vien":"Nhân viên","Cham cong":"Chấm công","Nghi phep":"Nghỉ phép","Boi hoan":"Bồi hoàn",Luong:"Lương","Hieu suat":"Hiệu suất"};return t[e]||e},D=e=>{const t={"Nhan vien":"primary","Cham cong":"success","Nghi phep":"warning","Boi hoan":"danger",Luong:"info","Hieu suat":""};return t[e]||""};return(0,a.sV)(async()=>{await A(),await C()}),(e,t)=>{const n=(0,a.g2)("el-button"),r=(0,a.g2)("el-tag"),i=(0,a.g2)("el-input"),l=(0,a.g2)("el-col"),b=(0,a.g2)("el-text"),R=(0,a.g2)("el-row"),A=(0,a.g2)("el-divider"),C=(0,a.g2)("el-card"),j=(0,a.g2)("el-table-column"),X=(0,a.g2)("el-table"),O=(0,a.g2)("el-pagination"),V=(0,a.gN)("loading");return(0,a.uX)(),(0,a.CE)("div",u,[(0,a.Lk)("div",c,[(0,a.Lk)("div",s,[(0,a.bF)(n,{icon:(0,a.R1)(o.ArrowLeft),onClick:T},{default:(0,a.k6)(()=>[...t[3]||(t[3]=[(0,a.eW)("Quay lại",-1)])]),_:1},8,["icon"]),(0,a.Lk)("div",h,[(0,a.Lk)("h1",g,(0,a.v_)(f.value?.ten_bao_cao||"Báo cáo"),1),f.value?((0,a.uX)(),(0,a.Wv)(r,{key:0,type:D(f.value.loai_bao_cao)},{default:(0,a.k6)(()=>[(0,a.eW)((0,a.v_)(K(f.value.loai_bao_cao)),1)]),_:1},8,["type"])):(0,a.Q3)("",!0)])]),(0,a.Lk)("div",d,[(0,a.bF)(n,{icon:(0,a.R1)(o.Refresh),loading:y.value,onClick:L},{default:(0,a.k6)(()=>[...t[4]||(t[4]=[(0,a.eW)(" Tải lại ",-1)])]),_:1},8,["icon","loading"]),(0,a.bF)(n,{icon:(0,a.R1)(o.Printer),onClick:S},{default:(0,a.k6)(()=>[...t[5]||(t[5]=[(0,a.eW)(" In báo cáo ",-1)])]),_:1},8,["icon"]),(0,a.bF)(n,{type:"success",icon:(0,a.R1)(o.Download),onClick:N},{default:(0,a.k6)(()=>[...t[6]||(t[6]=[(0,a.eW)(" Xuất CSV ",-1)])]),_:1},8,["icon"])])]),(0,a.bF)(C,{class:"filter-card",shadow:"never"},{default:(0,a.k6)(()=>[(0,a.bF)(R,{gutter:16},{default:(0,a.k6)(()=>[(0,a.bF)(l,{xs:24,sm:12,md:8},{default:(0,a.k6)(()=>[(0,a.bF)(i,{modelValue:w.value,"onUpdate:modelValue":t[0]||(t[0]=e=>w.value=e),placeholder:"Tìm kiếm trong kết quả...","prefix-icon":(0,a.R1)(o.Search),clearable:"",onInput:P},null,8,["modelValue","prefix-icon"])]),_:1}),(0,a.bF)(l,{xs:24,sm:12,md:8},{default:(0,a.k6)(()=>[(0,a.bF)(b,{type:"info"},{default:(0,a.k6)(()=>[(0,a.eW)(" Tổng số bản ghi: "+(0,a.v_)(x.total),1)]),_:1})]),_:1})]),_:1}),f.value&&f.value.tieu_chi.length>0?((0,a.uX)(),(0,a.CE)("div",v,[(0,a.bF)(A,{"content-position":"left"},{default:(0,a.k6)(()=>[...t[7]||(t[7]=[(0,a.eW)("Tiêu chí đã áp dụng",-1)])]),_:1}),(0,a.Lk)("div",p,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(f.value.tieu_chi,(e,t)=>((0,a.uX)(),(0,a.Wv)(r,{key:t,type:"info",size:"large"},{default:(0,a.k6)(()=>[(0,a.eW)((0,a.v_)(W(e.truong))+" "+(0,a.v_)(e.dieu_kien)+" "+(0,a.v_)(e.gia_tri),1)]),_:2},1024))),128))])])):(0,a.Q3)("",!0)]),_:1}),(0,a.bF)(C,{class:"table-card",shadow:"never"},{default:(0,a.k6)(()=>[(0,a.bo)(((0,a.uX)(),(0,a.Wv)(X,{data:I.value,style:{width:"100%"},stripe:"",border:"","empty-text":m.value||"Không có dữ liệu","default-sort":k.value,onSortChange:B},{default:(0,a.k6)(()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(E.value,e=>((0,a.uX)(),(0,a.Wv)(j,{key:e,prop:e,label:W(e),"min-width":"150",sortable:"custom"},{default:(0,a.k6)(({row:t})=>[(0,a.eW)((0,a.v_)(H($(t,e))),1)]),_:2},1032,["prop","label"]))),128))]),_:1},8,["data","empty-text","default-sort"])),[[V,y.value]]),(0,a.Lk)("div",_,[(0,a.bF)(O,{"current-page":x.currentPage,"onUpdate:currentPage":t[1]||(t[1]=e=>x.currentPage=e),"page-size":x.limit,"onUpdate:pageSize":t[2]||(t[2]=e=>x.limit=e),"page-sizes":[10,20,50,100,200],total:x.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:F,onCurrentChange:U},null,8,["current-page","page-size","total"])])]),_:1})])}}}),b=n(6262);const y=(0,b.A)(f,[["__scopeId","data-v-d0003a14"]]);var m=y},8237:function(e,t,n){var a=n(6518),r=n(2652),o=n(9306),i=n(8551),l=n(1767),u=n(9539),c=n(4549),s=n(8745),h=n(9039),g=TypeError,d=h(function(){[].keys().reduce(function(){},void 0)}),v=!d&&c("reduce",g);a({target:"Iterator",proto:!0,real:!0,forced:d||v},{reduce:function(e){i(this);try{o(e)}catch(h){u(this,"throw",h)}var t=arguments.length<2,n=t?void 0:arguments[1];if(v)return s(v,this,t?[e]:[e,n]);var a=l(this),c=0;if(r(a,function(a){t?(t=!1,n=a):n=e(n,a,c),c++},{IS_RECORD:!0}),t)throw new g("Reduce of empty iterator with no initial value");return n}})},8745:function(e,t,n){var a=n(616),r=Function.prototype,o=r.apply,i=r.call;e.exports="object"==typeof Reflect&&Reflect.apply||(a?i.bind(o):function(){return i.apply(o,arguments)})},9462:function(e,t,n){var a=n(9565),r=n(2360),o=n(6699),i=n(6279),l=n(8227),u=n(1181),c=n(5966),s=n(7657).IteratorPrototype,h=n(2529),g=n(9539),d=n(1385),v=l("toStringTag"),p="IteratorHelper",_="WrapForValidIterator",f="normal",b="throw",y=u.set,m=function(e){var t=u.getterFor(e?_:p);return i(r(s),{next:function(){var n=t(this);if(e)return n.nextHandler();if(n.done)return h(void 0,!0);try{var a=n.nextHandler();return n.returnHandlerResult?a:h(a,n.done)}catch(r){throw n.done=!0,r}},return:function(){var n=t(this),r=n.iterator;if(n.done=!0,e){var o=c(r,"return");return o?a(o,r):h(void 0,!0)}if(n.inner)try{g(n.inner.iterator,f)}catch(i){return g(r,b,i)}if(n.openIters)try{d(n.openIters,f)}catch(i){return g(r,b,i)}return r&&g(r,f),h(void 0,!0)}})},w=m(!0),x=m(!1);o(x,v,"Iterator Helper"),e.exports=function(e,t,n){var a=function(a,r){r?(r.iterator=a.iterator,r.next=a.next):r=a,r.type=t?_:p,r.returnHandlerResult=!!n,r.nextHandler=e,r.counter=0,r.done=!1,y(this,r)};return a.prototype=t?w:x,a}}}]);
//# sourceMappingURL=8120.86867f39.js.map