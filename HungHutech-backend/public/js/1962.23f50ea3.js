"use strict";(self["webpackChunkHungHutech"]=self["webpackChunkHungHutech"]||[]).push([[1962],{1114:function(e,a,l){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}function n(e,a){if("object"!=t(e)||!e)return e;var l=e[Symbol.toPrimitive];if(void 0!==l){var n=l.call(e,a||"default");if("object"!=t(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===a?String:Number)(e)}function i(e){var a=n(e,"string");return"symbol"==t(a)?a:a+""}function o(e,a,l){return(a=i(a))in e?Object.defineProperty(e,a,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[a]=l,e}l.d(a,{A:function(){return o}})},1526:function(e,a,l){var t=l(1114),n=l(4335);const i=window?.appGlobal?.baseUrl&&`${window.appGlobal.baseUrl}/api`,o=i||"http://192.168.88.50:5000/api";console.log("API Base URL:",o);class u{constructor(){(0,t.A)(this,"axiosInstance",void 0),this.axiosInstance=n.A.create({baseURL:o,headers:{"Content-Type":"application/json"}}),this.axiosInstance.interceptors.request.use(e=>{const a=localStorage.getItem("token");return a&&(e.headers.Authorization=`Bearer ${a}`),e},e=>Promise.reject(e)),this.axiosInstance.interceptors.response.use(e=>e,e=>(401===e.response?.status&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login"),Promise.reject(e)))}get(e,a){return this.axiosInstance.get(e,a)}post(e,a,l){return this.axiosInstance.post(e,a,l)}put(e,a,l){return this.axiosInstance.put(e,a,l)}delete(e,a){return this.axiosInstance.delete(e,a)}patch(e,a,l){return this.axiosInstance.patch(e,a,l)}}a.A=new u},1962:function(e,a,l){l.r(a),l.d(a,{default:function(){return m}});var t=l(1431),n=l(163),i=l(7918),o=l(8548),u=l(3306),r=l(6604);const d={class:"doc-page"},s={class:"page-header"},c={class:"emp-info"},_={key:0},h={key:1},p={class:"pagination"};var g=(0,t.pM)({__name:"EmployeeDocuments",setup(e){const a=[{label:"Hồ sơ lao động",value:"ho_so_lao_dong"},{label:"Hồ sơ BHXH",value:"ho_so_bhxh"},{label:"Hồ sơ nội bộ",value:"ho_so_noi_bo"},{label:"Hồ sơ pháp lý",value:"ho_so_phap_ly"}],l=(0,t.Kh)({nhan_vien_id:"",folder:"",q:""}),g=(0,t.KR)([]),f=(0,t.KR)([]),b=(0,t.KR)(!1),m=(0,t.KR)(!1),v=(0,t.Kh)({page:1,limit:10,total:0}),y=(0,t.KR)(!1),k=(0,t.KR)(),w=(0,t.Kh)({nhan_vien_id:"",folder:"",tieu_de:"",file_url:"",mo_ta:"",dateRange:[]}),F={nhan_vien_id:[{required:!0,message:"Chọn nhân viên",trigger:"change"}],folder:[{required:!0,message:"Chọn ngăn hồ sơ",trigger:"change"}],tieu_de:[{required:!0,message:"Nhập tiêu đề",trigger:"blur"}],file_url:[{required:!0,message:"Nhập đường dẫn tài liệu",trigger:"blur"}]},A=async()=>{const e=await r.A.getAll({page:1,limit:200});f.value=e.data||[]},V=async()=>{b.value=!0;try{const e={page:v.page,limit:v.limit,q:l.q||void 0,nhan_vien_id:l.nhan_vien_id||void 0,folder:l.folder||void 0},a=await u.A.getAll(e);g.value=a.data||[],v.total=a.pagination?.total||0}catch(e){n.nk.error(e.response?.data?.msg||"Không thể tải tài liệu")}finally{b.value=!1}},R=e=>e&&"string"!==typeof e?`${e.ho_dem||""} ${e.ten||""}`.trim():"",L=e=>e?new Date(e).toLocaleDateString("vi-VN"):"",U=e=>a.find(a=>a.value===e)?.label||e,C=()=>{v.page=1,V()},x=()=>{l.q="",l.folder="",l.nhan_vien_id="",C()},S=e=>{v.page=e,V()},E=()=>{y.value=!0},$=()=>{y.value=!1,w.nhan_vien_id="",w.folder="",w.tieu_de="",w.file_url="",w.mo_ta="",w.dateRange=[]},I=async()=>{k.value&&await k.value.validate(async e=>{if(e){m.value=!0;try{await u.A.create({nhan_vien_id:w.nhan_vien_id,folder:w.folder||"ho_so_lao_dong",tieu_de:w.tieu_de,file_url:w.file_url,mo_ta:w.mo_ta,ngay_hieu_luc:w.dateRange[0],ngay_het_han:w.dateRange[1]}),n.nk.success("Đã thêm tài liệu"),$(),V()}catch(a){n.nk.error(a.response?.data?.msg||"Không thể lưu tài liệu")}finally{m.value=!1}}})},H=async e=>{try{await i.s.confirm("Xóa tài liệu này?","Xác nhận",{type:"warning"}),await u.A.delete(e),n.nk.success("Đã xóa tài liệu"),V()}catch(a){if("cancel"===a)return;n.nk.error(a.response?.data?.msg||"Không thể xóa tài liệu")}},K=e=>{e.file_url&&window.open(e.file_url,"_blank")};return(0,t.sV)(()=>{A(),V()}),(e,n)=>{const i=(0,t.g2)("el-button"),u=(0,t.g2)("el-option"),r=(0,t.g2)("el-select"),A=(0,t.g2)("el-form-item"),V=(0,t.g2)("el-input"),B=(0,t.g2)("el-form"),X=(0,t.g2)("el-card"),N=(0,t.g2)("el-table-column"),q=(0,t.g2)("el-tag"),T=(0,t.g2)("el-space"),W=(0,t.g2)("el-table"),P=(0,t.g2)("el-pagination"),j=(0,t.g2)("el-date-picker"),D=(0,t.g2)("el-dialog"),z=(0,t.gN)("loading");return(0,t.uX)(),(0,t.CE)("div",d,[(0,t.Lk)("div",s,[n[11]||(n[11]=(0,t.Lk)("div",null,[(0,t.Lk)("h1",null,"Hồ sơ nhân sự"),(0,t.Lk)("p",null," Quản lý tài liệu theo từng ngăn hồ sơ (Lao động, BHXH, Nội bộ, Pháp lý). ")],-1)),(0,t.bF)(i,{type:"primary",icon:(0,t.R1)(o.Plus),onClick:E},{default:(0,t.k6)(()=>[...n[10]||(n[10]=[(0,t.eW)("Tải tài liệu",-1)])]),_:1},8,["icon"])]),(0,t.bF)(X,{class:"filter-card",shadow:"never"},{default:(0,t.k6)(()=>[(0,t.bF)(B,{inline:""},{default:(0,t.k6)(()=>[(0,t.bF)(A,{label:"Nhân viên"},{default:(0,t.k6)(()=>[(0,t.bF)(r,{modelValue:l.nhan_vien_id,"onUpdate:modelValue":n[0]||(n[0]=e=>l.nhan_vien_id=e),filterable:"",placeholder:"Tất cả",style:{width:"220px"}},{default:(0,t.k6)(()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(f.value,e=>((0,t.uX)(),(0,t.Wv)(u,{key:e._id,label:`${e.ma_nhan_vien} - ${e.ho_dem} ${e.ten}`,value:e._id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,t.bF)(A,{label:"Ngăn hồ sơ"},{default:(0,t.k6)(()=>[(0,t.bF)(r,{modelValue:l.folder,"onUpdate:modelValue":n[1]||(n[1]=e=>l.folder=e),placeholder:"Tất cả",style:{width:"200px"}},{default:(0,t.k6)(()=>[((0,t.uX)(),(0,t.CE)(t.FK,null,(0,t.pI)(a,e=>(0,t.bF)(u,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),(0,t.bF)(A,{label:"Từ khóa"},{default:(0,t.k6)(()=>[(0,t.bF)(V,{modelValue:l.q,"onUpdate:modelValue":n[2]||(n[2]=e=>l.q=e),placeholder:"Tên tài liệu...",clearable:"","prefix-icon":(0,t.R1)(o.Search),onKeyup:(0,t.jR)(C,["enter","native"])},null,8,["modelValue","prefix-icon"])]),_:1}),(0,t.bF)(A,null,{default:(0,t.k6)(()=>[(0,t.bF)(i,{type:"primary",onClick:C},{default:(0,t.k6)(()=>[...n[12]||(n[12]=[(0,t.eW)("Lọc",-1)])]),_:1}),(0,t.bF)(i,{onClick:x},{default:(0,t.k6)(()=>[...n[13]||(n[13]=[(0,t.eW)("Xóa lọc",-1)])]),_:1})]),_:1})]),_:1})]),_:1}),(0,t.bF)(X,{shadow:"never"},{default:(0,t.k6)(()=>[(0,t.bo)(((0,t.uX)(),(0,t.Wv)(W,{data:g.value,"empty-text":b.value?"Đang tải...":"Chưa có tài liệu",stripe:""},{default:(0,t.k6)(()=>[(0,t.bF)(N,{label:"Nhân viên","min-width":"200"},{default:(0,t.k6)(({row:e})=>[(0,t.Lk)("div",c,[(0,t.Lk)("strong",null,(0,t.v_)(e.nhan_vien_id?.ma_nhan_vien),1),(0,t.Lk)("span",null,(0,t.v_)(R(e.nhan_vien_id)),1)])]),_:1}),(0,t.bF)(N,{prop:"tieu_de",label:"Tên tài liệu","min-width":"220"}),(0,t.bF)(N,{label:"Ngăn hồ sơ",width:"160"},{default:(0,t.k6)(({row:e})=>[(0,t.bF)(q,{type:"info"},{default:(0,t.k6)(()=>[(0,t.eW)((0,t.v_)(U(e.folder)),1)]),_:2},1024)]),_:1}),(0,t.bF)(N,{label:"Hiệu lực","min-width":"200"},{default:(0,t.k6)(({row:e})=>[e.ngay_hieu_luc?((0,t.uX)(),(0,t.CE)("span",_,(0,t.v_)(L(e.ngay_hieu_luc))+" - "+(0,t.v_)(e.ngay_het_han?L(e.ngay_het_han):"Không xác định"),1)):((0,t.uX)(),(0,t.CE)("span",h,"---"))]),_:1}),(0,t.bF)(N,{label:"Hành động",width:"180",fixed:"right"},{default:(0,t.k6)(({row:e})=>[(0,t.bF)(T,null,{default:(0,t.k6)(()=>[(0,t.bF)(i,{size:"small",icon:(0,t.R1)(o.View),onClick:a=>K(e)},{default:(0,t.k6)(()=>[...n[14]||(n[14]=[(0,t.eW)("Xem",-1)])]),_:1},8,["icon","onClick"]),(0,t.bF)(i,{size:"small",type:"danger",icon:(0,t.R1)(o.Delete),onClick:a=>H(e._id)},{default:(0,t.k6)(()=>[...n[15]||(n[15]=[(0,t.eW)(" Xóa ",-1)])]),_:1},8,["icon","onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data","empty-text"])),[[z,b.value]]),(0,t.Lk)("div",p,[(0,t.bF)(P,{layout:"total, prev, pager, next",total:v.total,"page-size":v.limit,"current-page":v.page,onCurrentChange:S},null,8,["total","page-size","current-page"])])]),_:1}),(0,t.bF)(D,{modelValue:y.value,"onUpdate:modelValue":n[9]||(n[9]=e=>y.value=e),title:"Tải tài liệu",width:"520px"},{footer:(0,t.k6)(()=>[(0,t.bF)(i,{onClick:$},{default:(0,t.k6)(()=>[...n[16]||(n[16]=[(0,t.eW)("Hủy",-1)])]),_:1}),(0,t.bF)(i,{type:"primary",loading:m.value,onClick:I},{default:(0,t.k6)(()=>[...n[17]||(n[17]=[(0,t.eW)("Lưu tài liệu",-1)])]),_:1},8,["loading"])]),default:(0,t.k6)(()=>[(0,t.bF)(B,{ref_key:"formRef",ref:k,model:w,rules:F,"label-width":"140px"},{default:(0,t.k6)(()=>[(0,t.bF)(A,{label:"Nhân viên",prop:"nhan_vien_id"},{default:(0,t.k6)(()=>[(0,t.bF)(r,{modelValue:w.nhan_vien_id,"onUpdate:modelValue":n[3]||(n[3]=e=>w.nhan_vien_id=e),filterable:"",placeholder:"Chọn nhân viên"},{default:(0,t.k6)(()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(f.value,e=>((0,t.uX)(),(0,t.Wv)(u,{key:e._id,label:`${e.ma_nhan_vien} - ${e.ho_dem} ${e.ten}`,value:e._id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,t.bF)(A,{label:"Ngăn hồ sơ",prop:"folder"},{default:(0,t.k6)(()=>[(0,t.bF)(r,{modelValue:w.folder,"onUpdate:modelValue":n[4]||(n[4]=e=>w.folder=e),placeholder:"Chọn ngăn"},{default:(0,t.k6)(()=>[((0,t.uX)(),(0,t.CE)(t.FK,null,(0,t.pI)(a,e=>(0,t.bF)(u,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),(0,t.bF)(A,{label:"Tiêu đề",prop:"tieu_de"},{default:(0,t.k6)(()=>[(0,t.bF)(V,{modelValue:w.tieu_de,"onUpdate:modelValue":n[5]||(n[5]=e=>w.tieu_de=e),placeholder:"VD: Hợp đồng thử việc"},null,8,["modelValue"])]),_:1}),(0,t.bF)(A,{label:"Đường dẫn file",prop:"file_url"},{default:(0,t.k6)(()=>[(0,t.bF)(V,{modelValue:w.file_url,"onUpdate:modelValue":n[6]||(n[6]=e=>w.file_url=e),placeholder:"URL tài liệu hoặc đường dẫn upload"},null,8,["modelValue"])]),_:1}),(0,t.bF)(A,{label:"Hiệu lực"},{default:(0,t.k6)(()=>[(0,t.bF)(j,{modelValue:w.dateRange,"onUpdate:modelValue":n[7]||(n[7]=e=>w.dateRange=e),type:"daterange","value-format":"YYYY-MM-DD","range-separator":"Đến","start-placeholder":"Từ ngày","end-placeholder":"Đến ngày",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),(0,t.bF)(A,{label:"Mô tả"},{default:(0,t.k6)(()=>[(0,t.bF)(V,{modelValue:w.mo_ta,"onUpdate:modelValue":n[8]||(n[8]=e=>w.mo_ta=e),type:"textarea",rows:"3",placeholder:"Ghi chú thêm"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}}),f=l(6262);const b=(0,f.A)(g,[["__scopeId","data-v-6b0822e0"]]);var m=b},3306:function(e,a,l){var t=l(1114),n=l(1526);class i{constructor(){(0,t.A)(this,"BASE_URL","/employee-documents")}async getAll(e){const a=await n.A.get(this.BASE_URL,{params:e});return a.data}async getMy(e){const a=await n.A.get(`${this.BASE_URL}/my`,{params:e});return a.data}async create(e){const a=await n.A.post(this.BASE_URL,e);return a.data}async update(e,a){const l=await n.A.put(`${this.BASE_URL}/${e}`,a);return l.data}async delete(e){await n.A.delete(`${this.BASE_URL}/${e}`)}}a.A=new i},6262:function(e,a){a.A=(e,a)=>{const l=e.__vccOpts||e;for(const[t,n]of a)l[t]=n;return l}},6604:function(e,a,l){var t=l(1114),n=l(1526);class i{constructor(){(0,t.A)(this,"BASE_URL","/nhanvien")}async getAll(e){const a=await n.A.get(this.BASE_URL,{params:e});return a.data}async getById(e){const a=await n.A.get(`${this.BASE_URL}/${e}`);return a.data}async create(e){const a=await n.A.post(this.BASE_URL,e);return a.data}async update(e,a){const l=await n.A.put(`${this.BASE_URL}/${e}`,a);return l.data}async delete(e){await n.A.delete(`${this.BASE_URL}/${e}`)}}a.A=new i}}]);
//# sourceMappingURL=1962.23f50ea3.js.map