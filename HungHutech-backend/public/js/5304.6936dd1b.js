"use strict";(self["webpackChunkHungHutech"]=self["webpackChunkHungHutech"]||[]).push([[5304],{590:function(e,t,a){var n=a(1114),l=a(1526);class o{constructor(){(0,n.A)(this,"BASE_URL","/activities")}async getAll(e){const t=await l.A.get(this.BASE_URL,{params:e});return t.data}async getById(e){const t=await l.A.get(`${this.BASE_URL}/${e}`);return t.data}async create(e){const t=await l.A.post(this.BASE_URL,e);return t.data}async update(e,t){const a=await l.A.put(`${this.BASE_URL}/${e}`,t);return a.data}async delete(e){await l.A.delete(`${this.BASE_URL}/${e}`)}}t.A=new o},1114:function(e,t,a){function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function l(e,t){if("object"!=n(e)||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var l=a.call(e,t||"default");if("object"!=n(l))return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function o(e){var t=l(e,"string");return"symbol"==n(t)?t:t+""}function r(e,t,a){return(t=o(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}a.d(t,{A:function(){return r}})},1526:function(e,t,a){var n=a(1114),l=a(4335);const o=window?.appGlobal?.baseUrl&&`${window.appGlobal.baseUrl}/api`,r=o||"http://192.168.88.50:5000/api";console.log("API Base URL:",r);class i{constructor(){(0,n.A)(this,"axiosInstance",void 0),this.axiosInstance=l.A.create({baseURL:r,headers:{"Content-Type":"application/json"}}),this.axiosInstance.interceptors.request.use(e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e)),this.axiosInstance.interceptors.response.use(e=>e,e=>(401===e.response?.status&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login"),Promise.reject(e)))}get(e,t){return this.axiosInstance.get(e,t)}post(e,t,a){return this.axiosInstance.post(e,t,a)}put(e,t,a){return this.axiosInstance.put(e,t,a)}delete(e,t){return this.axiosInstance.delete(e,t)}patch(e,t,a){return this.axiosInstance.patch(e,t,a)}}t.A=new i},2923:function(e,t,a){a.r(t),a.d(t,{default:function(){return _}});var n=a(1431),l=a(8548),o=a(163),r=a(7918),i=a(590),u=a(3028);const c={class:"orangehrm-activity-list"},s={class:"orangehrm-card-header"},d={class:"orangehrm-filter-section"},h={class:"orangehrm-pagination"};var g=(0,n.pM)({__name:"ActivityList",setup(e){const t=(0,n.KR)(),a=(0,n.KR)(!1),g=(0,n.KR)(!1),p=(0,n.KR)(!1),m=(0,n.KR)(!1),_=(0,n.KR)(""),v=(0,n.KR)(""),b=(0,n.KR)(1),f=(0,n.KR)(10),y=(0,n.KR)(0),w=(0,n.KR)([]),k=(0,n.KR)([]),A=(0,n.Kh)({project_id:"",ten:"",mo_ta:"",trang_thai:"Đang hoạt động",_id:""}),F={project_id:[{required:!0,message:"Vui lòng chọn dự án",trigger:"change"}],ten:[{required:!0,message:"Vui lòng nhập tên hoạt động",trigger:"blur"}],trang_thai:[{required:!0,message:"Vui lòng chọn trạng thái",trigger:"change"}]},R=async()=>{a.value=!0;try{const e={page:b.value,limit:f.value,q:_.value};v.value&&(e.project_id=v.value);const t=await i.A.getAll(e);w.value=t.data||[],y.value=t.pagination?.total||0}catch(e){console.error("Error loading activities:",e),o.nk.error(e.response?.data?.msg||"Không thể tải danh sách hoạt động")}finally{a.value=!1}},S=async()=>{try{const e=await u.A.getAll({limit:1e3});k.value=e.data||[]}catch(e){console.error("Error loading projects:",e)}},U=e=>{const t={"Đang hoạt động":"success","Hoàn thành":"info","Tạm dừng":"warning"};return t[e]||"info"},V=()=>{m.value=!1,A.project_id="",A.ten="",A.mo_ta="",A.trang_thai="Đang hoạt động",A._id="",p.value=!0},j=e=>{m.value=!0,A.project_id=e.project_id?._id||e.project_id||"",A.ten=e.ten||"",A.mo_ta=e.mo_ta||"",A.trang_thai=e.trang_thai||"Đang hoạt động",A._id=e._id,p.value=!0},C=async e=>{try{await r.s.confirm(`Bạn có chắc chắn muốn xóa hoạt động "${e.ten}"?`,"Xác nhận xóa",{confirmButtonText:"Xóa",cancelButtonText:"Hủy",type:"warning"}),await i.A.delete(e._id),o.nk.success("Xóa hoạt động thành công"),R()}catch(t){"cancel"!==t&&o.nk.error(t.response?.data?.msg||"Không thể xóa hoạt động")}},x=async()=>{if(t.value)try{const e=await t.value.validate();if(!e)return;g.value=!0;const a={project_id:A.project_id,ten:A.ten,mo_ta:A.mo_ta,trang_thai:A.trang_thai};m.value?(await i.A.update(A._id,a),o.nk.success("Cập nhật hoạt động thành công")):(await i.A.create(a),o.nk.success("Thêm hoạt động mới thành công")),p.value=!1,R()}catch(e){o.nk.error(e.response?.data?.msg||"Không thể lưu hoạt động")}finally{g.value=!1}},L=()=>{b.value=1,R()},B=()=>{b.value=1,R()},E=()=>{R()};return(0,n.sV)(()=>{R(),S()}),(e,o)=>{const r=(0,n.g2)("el-button"),i=(0,n.g2)("el-option"),u=(0,n.g2)("el-select"),R=(0,n.g2)("el-col"),S=(0,n.g2)("el-input"),K=(0,n.g2)("el-row"),I=(0,n.g2)("el-table-column"),T=(0,n.g2)("el-tag"),$=(0,n.g2)("el-table"),H=(0,n.g2)("el-pagination"),W=(0,n.g2)("el-card"),X=(0,n.g2)("el-form-item"),z=(0,n.g2)("el-form"),q=(0,n.g2)("el-dialog"),P=(0,n.gN)("loading");return(0,n.uX)(),(0,n.CE)("div",c,[(0,n.bF)(W,{shadow:"never"},{header:(0,n.k6)(()=>[(0,n.Lk)("div",s,[o[11]||(o[11]=(0,n.Lk)("h2",{class:"orangehrm-card-title"},"Quản lý Hoạt động",-1)),(0,n.bF)(r,{type:"primary",icon:(0,n.R1)(l.Plus),onClick:V},{default:(0,n.k6)(()=>[...o[10]||(o[10]=[(0,n.eW)(" Thêm Hoạt động ",-1)])]),_:1},8,["icon"])])]),default:(0,n.k6)(()=>[(0,n.Lk)("div",d,[(0,n.bF)(K,{gutter:20},{default:(0,n.k6)(()=>[(0,n.bF)(R,{span:8},{default:(0,n.k6)(()=>[(0,n.bF)(u,{modelValue:v.value,"onUpdate:modelValue":o[0]||(o[0]=e=>v.value=e),placeholder:"Lọc theo dự án",clearable:"",filterable:"",style:{width:"100%"},onChange:L},{default:(0,n.k6)(()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(k.value,e=>((0,n.uX)(),(0,n.Wv)(i,{key:e._id,label:e.ten_du_an,value:e._id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,n.bF)(R,{span:8},{default:(0,n.k6)(()=>[(0,n.bF)(S,{modelValue:_.value,"onUpdate:modelValue":o[1]||(o[1]=e=>_.value=e),placeholder:"Tìm kiếm hoạt động...","prefix-icon":(0,n.R1)(l.Search),clearable:"",onClear:L,onKeyup:(0,n.jR)(L,["enter"])},null,8,["modelValue","prefix-icon"])]),_:1})]),_:1})]),(0,n.bo)(((0,n.uX)(),(0,n.Wv)($,{data:w.value,border:"",class:"orangehrm-table",style:{"margin-top":"20px"}},{default:(0,n.k6)(()=>[(0,n.bF)(I,{label:"Dự án","min-width":"150"},{default:(0,n.k6)(e=>[(0,n.eW)((0,n.v_)(e.row.project_id?.ten||"N/A"),1)]),_:1}),(0,n.bF)(I,{prop:"ten",label:"Tên hoạt động","min-width":"200"}),(0,n.bF)(I,{prop:"mo_ta",label:"Mô tả","min-width":"250","show-overflow-tooltip":""}),(0,n.bF)(I,{label:"Trạng thái",width:"120"},{default:(0,n.k6)(e=>[(0,n.bF)(T,{type:U(e.row.trang_thai)},{default:(0,n.k6)(()=>[(0,n.eW)((0,n.v_)(e.row.trang_thai),1)]),_:2},1032,["type"])]),_:1}),(0,n.bF)(I,{label:"Thao tác",width:"180",align:"center"},{default:(0,n.k6)(e=>[(0,n.bF)(r,{size:"small",icon:(0,n.R1)(l.Edit),onClick:t=>j(e.row)},{default:(0,n.k6)(()=>[...o[12]||(o[12]=[(0,n.eW)(" Sửa ",-1)])]),_:1},8,["icon","onClick"]),(0,n.bF)(r,{size:"small",type:"danger",icon:(0,n.R1)(l.Delete),onClick:t=>C(e.row)},{default:(0,n.k6)(()=>[...o[13]||(o[13]=[(0,n.eW)(" Xóa ",-1)])]),_:1},8,["icon","onClick"])]),_:1})]),_:1},8,["data"])),[[P,a.value]]),(0,n.Lk)("div",h,[(0,n.bF)(H,{"current-page":b.value,"onUpdate:currentPage":o[2]||(o[2]=e=>b.value=e),"page-size":f.value,"onUpdate:pageSize":o[3]||(o[3]=e=>f.value=e),"page-sizes":[10,20,50,100],total:y.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:B,onCurrentChange:E},null,8,["current-page","page-size","total"])])]),_:1}),(0,n.bF)(q,{modelValue:p.value,"onUpdate:modelValue":o[9]||(o[9]=e=>p.value=e),title:m.value?"Chỉnh sửa hoạt động":"Thêm hoạt động mới",width:"600px"},{footer:(0,n.k6)(()=>[(0,n.bF)(r,{onClick:o[8]||(o[8]=e=>p.value=!1)},{default:(0,n.k6)(()=>[...o[14]||(o[14]=[(0,n.eW)("Hủy",-1)])]),_:1}),(0,n.bF)(r,{type:"primary",loading:g.value,onClick:x},{default:(0,n.k6)(()=>[(0,n.eW)((0,n.v_)(m.value?"Cập nhật":"Thêm mới"),1)]),_:1},8,["loading"])]),default:(0,n.k6)(()=>[(0,n.bF)(z,{ref_key:"formRef",ref:t,model:A,rules:F,"label-width":"140px"},{default:(0,n.k6)(()=>[(0,n.bF)(X,{label:"Dự án",prop:"project_id",required:""},{default:(0,n.k6)(()=>[(0,n.bF)(u,{modelValue:A.project_id,"onUpdate:modelValue":o[4]||(o[4]=e=>A.project_id=e),placeholder:"Chọn dự án",filterable:"",style:{width:"100%"}},{default:(0,n.k6)(()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(k.value,e=>((0,n.uX)(),(0,n.Wv)(i,{key:e._id,label:e.ten,value:e._id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,n.bF)(X,{label:"Tên hoạt động",prop:"ten",required:""},{default:(0,n.k6)(()=>[(0,n.bF)(S,{modelValue:A.ten,"onUpdate:modelValue":o[5]||(o[5]=e=>A.ten=e),placeholder:"Nhập tên hoạt động"},null,8,["modelValue"])]),_:1}),(0,n.bF)(X,{label:"Mô tả",prop:"mo_ta"},{default:(0,n.k6)(()=>[(0,n.bF)(S,{modelValue:A.mo_ta,"onUpdate:modelValue":o[6]||(o[6]=e=>A.mo_ta=e),type:"textarea",rows:4,placeholder:"Mô tả chi tiết về hoạt động"},null,8,["modelValue"])]),_:1}),(0,n.bF)(X,{label:"Trạng thái",prop:"trang_thai",required:""},{default:(0,n.k6)(()=>[(0,n.bF)(u,{modelValue:A.trang_thai,"onUpdate:modelValue":o[7]||(o[7]=e=>A.trang_thai=e),placeholder:"Chọn trạng thái",style:{width:"100%"}},{default:(0,n.k6)(()=>[(0,n.bF)(i,{label:"Đang hoạt động",value:"Đang hoạt động"}),(0,n.bF)(i,{label:"Hoàn thành",value:"Hoàn thành"}),(0,n.bF)(i,{label:"Tạm dừng",value:"Tạm dừng"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}}),p=a(6262);const m=(0,p.A)(g,[["__scopeId","data-v-513a105d"]]);var _=m},3028:function(e,t,a){var n=a(1114),l=a(1526);class o{constructor(){(0,n.A)(this,"BASE_URL","/projects")}async getAll(e){const t=await l.A.get(this.BASE_URL,{params:e});return t.data}async getById(e){const t=await l.A.get(`${this.BASE_URL}/${e}`);return t.data}async create(e){const t=await l.A.post(this.BASE_URL,e);return t.data}async update(e,t){const a=await l.A.put(`${this.BASE_URL}/${e}`,t);return a.data}async delete(e){await l.A.delete(`${this.BASE_URL}/${e}`)}}t.A=new o},6262:function(e,t){t.A=(e,t)=>{const a=e.__vccOpts||e;for(const[n,l]of t)a[n]=l;return a}}}]);
//# sourceMappingURL=5304.6936dd1b.js.map