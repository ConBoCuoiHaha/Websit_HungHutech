"use strict";(self["webpackChunkHungHutech"]=self["webpackChunkHungHutech"]||[]).push([[7635],{1526:function(e,a,t){var n=t(1114),r=t(4335);const o=window?.appGlobal?.baseUrl&&`${window.appGlobal.baseUrl}/api`,i=o||"http://192.168.88.50:5000/api";console.log("API Base URL:",i);class l{constructor(){(0,n.A)(this,"axiosInstance",void 0),this.axiosInstance=r.A.create({baseURL:i,headers:{"Content-Type":"application/json"}}),this.axiosInstance.interceptors.request.use(e=>{const a=localStorage.getItem("token");return a&&(e.headers.Authorization=`Bearer ${a}`),e},e=>Promise.reject(e)),this.axiosInstance.interceptors.response.use(e=>e,e=>(401===e.response?.status&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login"),Promise.reject(e)))}get(e,a){return this.axiosInstance.get(e,a)}post(e,a,t){return this.axiosInstance.post(e,a,t)}put(e,a,t){return this.axiosInstance.put(e,a,t)}delete(e,a){return this.axiosInstance.delete(e,a)}patch(e,a,t){return this.axiosInstance.patch(e,a,t)}}a.A=new l},4114:function(e,a,t){var n=t(6518),r=t(8981),o=t(6198),i=t(4527),l=t(6837),s=t(9039),c=s(function(){return 4294967297!==[].push.call({length:4294967296},1)}),u=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(e){return e instanceof TypeError}},h=c||!u();n({target:"Array",proto:!0,arity:1,forced:h},{push:function(e){var a=r(this),t=o(a),n=arguments.length;l(t+n);for(var s=0;s<n;s++)a[t]=arguments[s],t++;return i(a,t),t}})},4376:function(e,a,t){var n=t(2195);e.exports=Array.isArray||function(e){return"Array"===n(e)}},4527:function(e,a,t){var n=t(3724),r=t(4376),o=TypeError,i=Object.getOwnPropertyDescriptor,l=n&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}();e.exports=l?function(e,a){if(r(e)&&!i(e,"length").writable)throw new o("Cannot set read only .length");return e.length=a}:function(e,a){return e.length=a}},6593:function(e,a,t){var n=t(1114),r=(t(8111),t(7588),t(1526));class o{constructor(){(0,n.A)(this,"BASE_URL","/chamcong")}async clockIn(e){const a=await r.A.post(`${this.BASE_URL}/clock-in`,e);return a.data}async clockOut(e){const a=await r.A.post(`${this.BASE_URL}/clock-out`,e);return a.data}async getHistory(e){const{nhan_vien_id:a,from:t,to:n}=e,o=await r.A.get(`${this.BASE_URL}/history/${a}`,{params:{from:t,to:n}});return o.data?.data||[]}async update(e,a){const t=await r.A.put(`${this.BASE_URL}/${e}`,a);return t.data}async getSummary(e,a,t){const n=await this.getHistory({nhan_vien_id:e,from:a,to:t}),r=this.calculateWorkDays(a,t),o=n.length,i=r-o;let l=0,s=0;return n.forEach(e=>{const a=new Date(e.thoi_gian_vao),t=new Date(a);if(t.setHours(8,30,0,0),a>t&&l++,e.thoi_gian_ra){const a=new Date(e.thoi_gian_vao),t=new Date(e.thoi_gian_ra),n=(t.getTime()-a.getTime())/36e5;s+=n}}),{total_days:r,present_days:o,absent_days:i,late_days:l,total_hours:Math.round(10*s)/10}}calculateWorkDays(e,a){const t=new Date(e),n=new Date(a);let r=0;const o=new Date(t);while(o<=n){const e=o.getDay();0!==e&&6!==e&&r++,o.setDate(o.getDate()+1)}return r}}a.A=new o},6604:function(e,a,t){var n=t(1114),r=t(1526);class o{constructor(){(0,n.A)(this,"BASE_URL","/nhanvien")}async getAll(e){const a=await r.A.get(this.BASE_URL,{params:e});return a.data}async getById(e){const a=await r.A.get(`${this.BASE_URL}/${e}`);return a.data}async create(e){const a=await r.A.post(this.BASE_URL,e);return a.data}async update(e,a){const t=await r.A.put(`${this.BASE_URL}/${e}`,a);return t.data}async delete(e){await r.A.delete(`${this.BASE_URL}/${e}`)}}a.A=new o},6837:function(e){var a=TypeError,t=9007199254740991;e.exports=function(e){if(e>t)throw a("Maximum allowed index exceeded");return e}},7588:function(e,a,t){var n=t(6518),r=t(9565),o=t(2652),i=t(9306),l=t(8551),s=t(1767),c=t(9539),u=t(4549),h=u("forEach",TypeError);n({target:"Iterator",proto:!0,real:!0,forced:h},{forEach:function(e){l(this);try{i(e)}catch(n){c(this,"throw",n)}if(h)return r(h,this,e);var a=s(this),t=0;o(a,function(a){e(a,t++)},{IS_RECORD:!0})}})},7635:function(e,a,t){t.r(a),t.d(a,{default:function(){return x}});t(4114);var n=t(1431),r=t(8548),o=t(163),i=t(6593),l=t(6604),s=t(7927);const c={class:"orangehrm-attendance-page"},u={class:"orangehrm-page-header"},h={class:"orangehrm-page-actions"},g={class:"orangehrm-today-header"},d={class:"orangehrm-today-info"},v={class:"orangehrm-today-text"},_={class:"orangehrm-today-date"},k={class:"orangehrm-today-day"},m={class:"orangehrm-today-time"},y={class:"orangehrm-clock"},f={class:"orangehrm-card-header"},p={class:"orangehrm-ot-employee"},w={class:"orangehrm-clock-content"},b={key:0,class:"orangehrm-clock-time"},A={key:1,class:"orangehrm-clock-empty"},L={class:"orangehrm-clock-content"},E={key:0,class:"orangehrm-clock-time"},F={key:1,class:"orangehrm-clock-empty"},R={key:0,class:"orangehrm-note"},W={class:"orangehrm-card-header"};var C=(0,n.pM)({__name:"AttendanceDaily",setup(e){const a=(0,n.KR)([]),t=(0,n.KR)(""),C=(0,n.KR)(null),S=(0,n.KR)([]),D=(0,n.KR)(!1),x=(0,n.KR)(!1),I=(0,n.KR)(!1),$=(0,n.KR)(""),U=(0,n.KR)("");let X;const B=(0,n.KR)(null),T=(0,n.EW)(()=>B.value?.month?.items?.slice(0,5)||[]),K=(0,n.EW)(()=>B.value?.month?.limit||0),V=(0,n.EW)(()=>{const e=new Date;return e.toLocaleDateString("vi-VN",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),z=(0,n.EW)(()=>C.value?J(C.value):0),G=(0,n.EW)(()=>{if(!C.value?.thoi_gian_vao)return!1;const e=new Date(C.value.thoi_gian_vao),a=new Date(e);return a.setHours(8,30,0,0),e>a}),H=(0,n.EW)(()=>G.value?"Đi muộn":"Đúng giờ"),P=(0,n.EW)(()=>G.value?"#E6A23C":"#67C23A"),O=()=>{const e=new Date;$.value=e.toLocaleTimeString("vi-VN",{hour:"2-digit",minute:"2-digit",second:"2-digit"}),U.value=e.toLocaleDateString("vi-VN",{weekday:"long"})},N=async()=>{try{const e=await l.A.getAll({limit:1e3});a.value=e.data||[],a.value.length>0&&!t.value&&(t.value=a.value[0]._id,await Q())}catch(e){console.error("Error loading employees:",e),o.nk.error("Không thể tải danh sách nhân viên")}},j=async()=>{try{B.value=await s.A.getAlerts()}catch(e){console.error("Error loading overtime alerts",e)}},Q=async()=>{if(t.value){D.value=!0;try{const e=new Date,a=e.toISOString().split("T")[0],n=await i.A.getHistory({nhan_vien_id:t.value,from:a,to:a}),r=Array.isArray(n)?n:n.items||[];C.value=r.length>0?r[0]:null;const o=new Date;o.setDate(o.getDate()-7);const l=o.toISOString().split("T")[0],s=await i.A.getHistory({nhan_vien_id:t.value,from:l,to:a}),c=Array.isArray(s)?s:s.items||[];S.value=c.slice(0,7)}catch(e){console.error("Error loading attendance:",e),o.nk.error(e.response?.data?.msg||"Không thể tải thông tin chấm công")}finally{D.value=!1}}},M=async()=>{if(t.value){x.value=!0;try{await i.A.clockIn({nhan_vien_id:t.value}),o.nk.success("Chấm công vào thành công"),await Q()}catch(e){console.error("Error clocking in:",e),o.nk.error(e.response?.data?.msg||"Không thể chấm công vào")}finally{x.value=!1}}},q=async()=>{if(t.value){I.value=!0;try{await i.A.clockOut({nhan_vien_id:t.value}),o.nk.success("Chấm công ra thành công"),await Q()}catch(e){console.error("Error clocking out:",e),o.nk.error(e.response?.data?.msg||"Không thể chấm công ra")}finally{I.value=!1}}},J=e=>{if(!e.thoi_gian_ra)return 0;const a=new Date(e.thoi_gian_vao),t=new Date(e.thoi_gian_ra),n=(t.getTime()-a.getTime())/36e5;return Math.round(10*n)/10},Y=e=>{const a=new Date(e.thoi_gian_vao),t=new Date(a);return t.setHours(8,30,0,0),a>t?"Đi muộn":"Đúng giờ"},Z=e=>"Đi muộn"===Y(e)?"warning":"success",ee=e=>{const a=new Date(e);return a.toLocaleTimeString("vi-VN",{hour:"2-digit",minute:"2-digit"})},ae=e=>{const a=new Date(e);return a.toLocaleDateString("vi-VN",{weekday:"short",day:"2-digit",month:"2-digit"})};return(0,n.sV)(()=>{O(),X=setInterval(O,1e3),N(),j()}),(0,n.hi)(()=>{X&&clearInterval(X)}),(e,o)=>{const i=(0,n.g2)("el-button"),l=(0,n.g2)("el-icon"),s=(0,n.g2)("el-card"),X=(0,n.g2)("el-tag"),B=(0,n.g2)("el-table-column"),O=(0,n.g2)("el-table"),N=(0,n.g2)("el-option"),j=(0,n.g2)("el-select"),te=(0,n.g2)("el-form-item"),ne=(0,n.g2)("el-form"),re=(0,n.g2)("el-col"),oe=(0,n.g2)("el-row"),ie=(0,n.g2)("el-statistic"),le=(0,n.g2)("el-empty"),se=(0,n.gN)("loading");return(0,n.uX)(),(0,n.CE)("div",c,[(0,n.Lk)("div",u,[o[3]||(o[3]=(0,n.Lk)("h1",{class:"orangehrm-page-title"},"Chấm công hàng ngày",-1)),(0,n.Lk)("div",h,[(0,n.bF)(i,{icon:(0,n.R1)(r.Refresh),onClick:Q},{default:(0,n.k6)(()=>[...o[2]||(o[2]=[(0,n.eW)(" Tải lại ",-1)])]),_:1},8,["icon"])])]),(0,n.bF)(s,{class:"orangehrm-today-card",shadow:"hover"},{default:(0,n.k6)(()=>[(0,n.Lk)("div",g,[(0,n.Lk)("div",d,[(0,n.bF)(l,{size:32,color:"#4A90E2"},{default:(0,n.k6)(()=>[(0,n.bF)((0,n.R1)(r.Calendar))]),_:1}),(0,n.Lk)("div",v,[(0,n.Lk)("h2",_,(0,n.v_)(V.value),1),(0,n.Lk)("p",k,(0,n.v_)(U.value),1)])]),(0,n.Lk)("div",m,[(0,n.Lk)("div",y,(0,n.v_)($.value),1)])])]),_:1}),T.value.length?((0,n.uX)(),(0,n.Wv)(s,{key:0,class:"orangehrm-ot-alert-card",shadow:"never"},{header:(0,n.k6)(()=>[(0,n.Lk)("div",f,[o[4]||(o[4]=(0,n.Lk)("span",null,"Canh bao tang ca (thang nay)",-1)),(0,n.bF)(X,{type:"warning"},{default:(0,n.k6)(()=>[(0,n.eW)("Gioi han "+(0,n.v_)(K.value)+"h",1)]),_:1})])]),default:(0,n.k6)(()=>[(0,n.bF)(O,{data:T.value,size:"small",border:""},{default:(0,n.k6)(()=>[(0,n.bF)(B,{label:"Nhan vien","min-width":"180"},{default:(0,n.k6)(({row:e})=>[(0,n.Lk)("div",p,[(0,n.Lk)("strong",null,(0,n.v_)(e.ho_ten),1),(0,n.Lk)("small",null,(0,n.v_)(e.ma_nhan_vien),1)])]),_:1}),(0,n.bF)(B,{prop:"phong_ban",label:"Phong ban","min-width":"120"}),(0,n.bF)(B,{label:"So gio",width:"140"},{default:(0,n.k6)(({row:e})=>[(0,n.eW)((0,n.v_)(e.hours.toFixed(2))+"h / "+(0,n.v_)(e.limit)+"h ",1)]),_:1}),(0,n.bF)(B,{label:"Ti le",width:"120",align:"center"},{default:(0,n.k6)(({row:e})=>[(0,n.bF)(X,{type:e.percent>=100?"danger":e.percent>=80?"warning":"success"},{default:(0,n.k6)(()=>[(0,n.eW)((0,n.v_)(e.percent.toFixed(1))+"% ",1)]),_:2},1032,["type"])]),_:1})]),_:1},8,["data"])]),_:1})):(0,n.Q3)("",!0),(0,n.bF)(s,{class:"orangehrm-employee-card",shadow:"never"},{default:(0,n.k6)(()=>[(0,n.bF)(ne,{inline:!0},{default:(0,n.k6)(()=>[(0,n.bF)(te,{label:"Chọn nhân viên"},{default:(0,n.k6)(()=>[(0,n.bF)(j,{modelValue:t.value,"onUpdate:modelValue":o[0]||(o[0]=e=>t.value=e),placeholder:"Chọn nhân viên",filterable:"",style:{width:"300px"},onChange:Q},{default:(0,n.k6)(()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(a.value,e=>((0,n.uX)(),(0,n.Wv)(N,{key:e._id,label:`${e.ho_dem} ${e.ten} (${e.ma_nhan_vien})`,value:e._id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),t.value?((0,n.uX)(),(0,n.Wv)(oe,{key:1,gutter:16},{default:(0,n.k6)(()=>[(0,n.bF)(re,{xs:24,md:12},{default:(0,n.k6)(()=>[(0,n.bF)(s,{class:"orangehrm-clock-card orangehrm-clock-in",shadow:"hover"},{default:(0,n.k6)(()=>[(0,n.Lk)("div",w,[(0,n.bF)(l,{size:48,color:"#67C23A"},{default:(0,n.k6)(()=>[(0,n.bF)((0,n.R1)(r.Timer))]),_:1}),o[7]||(o[7]=(0,n.Lk)("h3",null,"Giờ vào",-1)),C.value?.thoi_gian_vao?((0,n.uX)(),(0,n.CE)("div",b,(0,n.v_)(ee(C.value.thoi_gian_vao)),1)):((0,n.uX)(),(0,n.CE)("div",A,"Chưa chấm công")),C.value?.thoi_gian_vao?((0,n.uX)(),(0,n.Wv)(X,{key:3,type:"success",size:"large"},{default:(0,n.k6)(()=>[...o[6]||(o[6]=[(0,n.eW)("Đã chấm công vào",-1)])]),_:1})):((0,n.uX)(),(0,n.Wv)(i,{key:2,type:"success",size:"large",icon:(0,n.R1)(r.VideoPlay),loading:x.value,onClick:M},{default:(0,n.k6)(()=>[...o[5]||(o[5]=[(0,n.eW)(" Chấm công vào ",-1)])]),_:1},8,["icon","loading"]))])]),_:1})]),_:1}),(0,n.bF)(re,{xs:24,md:12},{default:(0,n.k6)(()=>[(0,n.bF)(s,{class:"orangehrm-clock-card orangehrm-clock-out",shadow:"hover"},{default:(0,n.k6)(()=>[(0,n.Lk)("div",L,[(0,n.bF)(l,{size:48,color:"#E6A23C"},{default:(0,n.k6)(()=>[(0,n.bF)((0,n.R1)(r.Timer))]),_:1}),o[11]||(o[11]=(0,n.Lk)("h3",null,"Giờ ra",-1)),C.value?.thoi_gian_ra?((0,n.uX)(),(0,n.CE)("div",E,(0,n.v_)(ee(C.value.thoi_gian_ra)),1)):((0,n.uX)(),(0,n.CE)("div",F,"Chưa chấm công")),C.value?.thoi_gian_vao&&!C.value?.thoi_gian_ra?((0,n.uX)(),(0,n.Wv)(i,{key:2,type:"warning",size:"large",icon:(0,n.R1)(r.VideoPause),loading:I.value,onClick:q},{default:(0,n.k6)(()=>[...o[8]||(o[8]=[(0,n.eW)(" Chấm công ra ",-1)])]),_:1},8,["icon","loading"])):C.value?.thoi_gian_ra?((0,n.uX)(),(0,n.Wv)(X,{key:3,type:"warning",size:"large"},{default:(0,n.k6)(()=>[...o[9]||(o[9]=[(0,n.eW)(" Đã chấm công ra ",-1)])]),_:1})):((0,n.uX)(),(0,n.Wv)(X,{key:4,type:"info",size:"large"},{default:(0,n.k6)(()=>[...o[10]||(o[10]=[(0,n.eW)("Chưa chấm công vào",-1)])]),_:1}))])]),_:1})]),_:1})]),_:1})):(0,n.Q3)("",!0),t.value&&C.value?((0,n.uX)(),(0,n.Wv)(s,{key:2,class:"orangehrm-summary-card",shadow:"never"},{header:(0,n.k6)(()=>[...o[12]||(o[12]=[(0,n.Lk)("div",{class:"orangehrm-card-header"},[(0,n.Lk)("span",null,"Tổng kết ngày hôm nay")],-1)])]),default:(0,n.k6)(()=>[(0,n.bF)(oe,{gutter:16},{default:(0,n.k6)(()=>[(0,n.bF)(re,{xs:12,sm:6},{default:(0,n.k6)(()=>[(0,n.bF)(ie,{title:"Giờ vào",value:ee(C.value.thoi_gian_vao)},{prefix:(0,n.k6)(()=>[(0,n.bF)(l,{color:"#67C23A"},{default:(0,n.k6)(()=>[(0,n.bF)((0,n.R1)(r.VideoPlay))]),_:1})]),_:1},8,["value"])]),_:1}),(0,n.bF)(re,{xs:12,sm:6},{default:(0,n.k6)(()=>[(0,n.bF)(ie,{title:"Giờ ra",value:C.value.thoi_gian_ra?ee(C.value.thoi_gian_ra):"-"},{prefix:(0,n.k6)(()=>[(0,n.bF)(l,{color:"#E6A23C"},{default:(0,n.k6)(()=>[(0,n.bF)((0,n.R1)(r.VideoPause))]),_:1})]),_:1},8,["value"])]),_:1}),(0,n.bF)(re,{xs:12,sm:6},{default:(0,n.k6)(()=>[(0,n.bF)(ie,{title:"Số giờ làm",value:z.value},{prefix:(0,n.k6)(()=>[(0,n.bF)(l,{color:"#4A90E2"},{default:(0,n.k6)(()=>[(0,n.bF)((0,n.R1)(r.Clock))]),_:1})]),suffix:(0,n.k6)(()=>[...o[13]||(o[13]=[(0,n.eW)("giờ",-1)])]),_:1},8,["value"])]),_:1}),(0,n.bF)(re,{xs:12,sm:6},{default:(0,n.k6)(()=>[(0,n.bF)(ie,{title:"Trạng thái",value:H.value},{prefix:(0,n.k6)(()=>[(0,n.bF)(l,{color:P.value},{default:(0,n.k6)(()=>[G.value?((0,n.uX)(),(0,n.Wv)((0,n.R1)(r.Warning),{key:1})):((0,n.uX)(),(0,n.Wv)((0,n.R1)(r.CircleCheck),{key:0}))]),_:1},8,["color"])]),_:1},8,["value"])]),_:1})]),_:1}),C.value.ghi_chu?((0,n.uX)(),(0,n.CE)("div",R,[o[14]||(o[14]=(0,n.Lk)("strong",null,"Ghi chú:",-1)),(0,n.eW)(" "+(0,n.v_)(C.value.ghi_chu),1)])):(0,n.Q3)("",!0)]),_:1})):(0,n.Q3)("",!0),t.value?((0,n.uX)(),(0,n.Wv)(s,{key:3,class:"orangehrm-history-card",shadow:"never"},{header:(0,n.k6)(()=>[(0,n.Lk)("div",W,[o[16]||(o[16]=(0,n.Lk)("span",null,"Lịch sử chấm công gần đây",-1)),(0,n.bF)(i,{text:"",type:"primary",onClick:o[1]||(o[1]=a=>e.$router.push("/cham-cong/bang-cong"))},{default:(0,n.k6)(()=>[...o[15]||(o[15]=[(0,n.eW)(" Xem tất cả ",-1)])]),_:1})])]),default:(0,n.k6)(()=>[(0,n.bo)(((0,n.uX)(),(0,n.Wv)(O,{data:S.value,style:{width:"100%"},stripe:""},{default:(0,n.k6)(()=>[(0,n.bF)(B,{prop:"ngay",label:"Ngày",width:"150"},{default:(0,n.k6)(({row:e})=>[(0,n.eW)((0,n.v_)(ae(e.ngay)),1)]),_:1}),(0,n.bF)(B,{label:"Giờ vào",width:"120"},{default:(0,n.k6)(({row:e})=>[(0,n.Lk)("strong",null,(0,n.v_)(ee(e.thoi_gian_vao)),1)]),_:1}),(0,n.bF)(B,{label:"Giờ ra",width:"120"},{default:(0,n.k6)(({row:e})=>[(0,n.Lk)("strong",null,(0,n.v_)(e.thoi_gian_ra?ee(e.thoi_gian_ra):"-"),1)]),_:1}),(0,n.bF)(B,{label:"Số giờ",width:"120"},{default:(0,n.k6)(({row:e})=>[(0,n.eW)((0,n.v_)(J(e))+" giờ ",1)]),_:1}),(0,n.bF)(B,{label:"Trạng thái",width:"120"},{default:(0,n.k6)(({row:e})=>[(0,n.bF)(X,{type:Z(e),size:"small"},{default:(0,n.k6)(()=>[(0,n.eW)((0,n.v_)(Y(e)),1)]),_:2},1032,["type"])]),_:1}),(0,n.bF)(B,{label:"Ghi chú","min-width":"200"},{default:(0,n.k6)(({row:e})=>[(0,n.eW)((0,n.v_)(e.ghi_chu||"-"),1)]),_:1})]),_:1},8,["data"])),[[se,D.value]])]),_:1})):(0,n.Q3)("",!0),t.value?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.Wv)(le,{key:4,description:"Vui lòng chọn nhân viên để chấm công","image-size":200}))])}}}),S=t(6262);const D=(0,S.A)(C,[["__scopeId","data-v-0c39d3bc"]]);var x=D},7927:function(e,a,t){var n=t(1114),r=t(1526);class o{constructor(){(0,n.A)(this,"BASE_URL","/overtime-requests")}async getAll(e){const a=await r.A.get(this.BASE_URL,{params:e});return a.data}async getMy(e){const a=await r.A.get(`${this.BASE_URL}/my`,{params:e});return a.data}async create(e){const a=await r.A.post(this.BASE_URL,e);return a.data}async updateStatus(e,a){const t=await r.A.put(`${this.BASE_URL}/${e}/status`,a);return t.data}async cancel(e){const a=await r.A.put(`${this.BASE_URL}/${e}/cancel`);return a.data}async getAlerts(){const e=await r.A.get(`${this.BASE_URL}/alerts`);return e.data}}a.A=new o}}]);
//# sourceMappingURL=7635.7694a566.js.map