"use strict";(self["webpackChunkHungHutech"]=self["webpackChunkHungHutech"]||[]).push([[7717],{397:function(t,e,n){var r=n(7751);t.exports=r("document","documentElement")},679:function(t,e,n){var r=n(1625),a=TypeError;t.exports=function(t,e){if(r(e,t))return t;throw new a("Incorrect invocation")}},684:function(t){t.exports=function(t,e){var n="function"==typeof Iterator&&Iterator.prototype[t];if(n)try{n.call({next:null},e).next()}catch(r){return!0}}},1072:function(t,e,n){var r=n(1828),a=n(8727);t.exports=Object.keys||function(t){return r(t,a)}},1114:function(t,e,n){function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function a(t,e){if("object"!=r(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var a=n.call(t,e||"default");if("object"!=r(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function o(t){var e=a(t,"string");return"symbol"==r(e)?e:e+""}function i(t,e,n){return(e=o(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}n.d(e,{A:function(){return i}})},1385:function(t,e,n){var r=n(9539);t.exports=function(t,e,n){for(var a=t.length-1;a>=0;a--)if(void 0!==t[a])try{n=r(t[a].iterator,e,n)}catch(o){e="throw",n=o}if("throw"===e)throw n;return n}},1526:function(t,e,n){var r=n(1114),a=n(4335);const o=window?.appGlobal?.baseUrl&&`${window.appGlobal.baseUrl}/api`,i=o||"http://192.168.88.50:5000/api";console.log("API Base URL:",i);class l{constructor(){(0,r.A)(this,"axiosInstance",void 0),this.axiosInstance=a.A.create({baseURL:i,headers:{"Content-Type":"application/json"}}),this.axiosInstance.interceptors.request.use(t=>{const e=localStorage.getItem("token");return e&&(t.headers.Authorization=`Bearer ${e}`),t},t=>Promise.reject(t)),this.axiosInstance.interceptors.response.use(t=>t,t=>(401===t.response?.status&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login"),Promise.reject(t)))}get(t,e){return this.axiosInstance.get(t,e)}post(t,e,n){return this.axiosInstance.post(t,e,n)}put(t,e,n){return this.axiosInstance.put(t,e,n)}delete(t,e){return this.axiosInstance.delete(t,e)}patch(t,e,n){return this.axiosInstance.patch(t,e,n)}}e.A=new l},1701:function(t,e,n){var r=n(6518),a=n(9565),o=n(9306),i=n(8551),l=n(1767),u=n(9462),c=n(6319),s=n(9539),h=n(684),d=n(4549),f=n(6395),g=!f&&!h("map",function(){}),p=!f&&!g&&d("map",TypeError),_=f||g||p,m=u(function(){var t=this.iterator,e=i(a(this.next,t)),n=this.done=!!e.done;if(!n)return c(t,this.mapper,[e.value,this.counter++],!0)});r({target:"Iterator",proto:!0,real:!0,forced:_},{map:function(t){i(this);try{o(t)}catch(e){s(this,"throw",e)}return p?a(p,this,t):new m(l(this),{mapper:t})}})},1767:function(t){t.exports=function(t){return{iterator:t,next:t.next,done:!1}}},2106:function(t,e,n){var r=n(283),a=n(4913);t.exports=function(t,e,n){return n.get&&r(n.get,e,{getter:!0}),n.set&&r(n.set,e,{setter:!0}),a.f(t,e,n)}},2211:function(t,e,n){var r=n(9039);t.exports=!r(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype})},2360:function(t,e,n){var r,a=n(8551),o=n(6801),i=n(8727),l=n(421),u=n(397),c=n(4055),s=n(6119),h=">",d="<",f="prototype",g="script",p=s("IE_PROTO"),_=function(){},m=function(t){return d+g+h+t+d+"/"+g+h},v=function(t){t.write(m("")),t.close();var e=t.parentWindow.Object;return t=null,e},b=function(){var t,e=c("iframe"),n="java"+g+":";return e.style.display="none",u.appendChild(e),e.src=String(n),t=e.contentWindow.document,t.open(),t.write(m("document.F=Object")),t.close(),t.F},y=function(){try{r=new ActiveXObject("htmlfile")}catch(e){}y="undefined"!=typeof document?document.domain&&r?v(r):b():v(r);var t=i.length;while(t--)delete y[f][i[t]];return y()};l[p]=!0,t.exports=Object.create||function(t,e){var n;return null!==t?(_[f]=a(t),n=new _,_[f]=null,n[p]=t):n=y(),void 0===e?n:o.f(n,e)}},2529:function(t){t.exports=function(t,e){return{value:t,done:e}}},2787:function(t,e,n){var r=n(9297),a=n(4901),o=n(8981),i=n(6119),l=n(2211),u=i("IE_PROTO"),c=Object,s=c.prototype;t.exports=l?c.getPrototypeOf:function(t){var e=o(t);if(r(e,u))return e[u];var n=e.constructor;return a(n)&&e instanceof n?n.prototype:e instanceof c?s:null}},3510:function(t,e,n){var r=n(1114),a=n(1526);class o{constructor(){(0,r.A)(this,"BASE_URL","/calamviec")}async getAll(t){const e=await a.A.get(this.BASE_URL,{params:t});return e.data}async getById(t){const e=await a.A.get(`${this.BASE_URL}/${t}`);return e.data}async create(t){const e=await a.A.post(this.BASE_URL,t);return e.data}async update(t,e){const n=await a.A.put(`${this.BASE_URL}/${t}`,e);return n.data}async delete(t){await a.A.delete(`${this.BASE_URL}/${t}`)}}e.A=new o},4549:function(t,e,n){var r=n(4576);t.exports=function(t,e){var n=r.Iterator,a=n&&n.prototype,o=a&&a[t],i=!1;if(o)try{o.call({next:function(){return{done:!0}},return:function(){i=!0}},-1)}catch(l){l instanceof e||(i=!1)}if(!i)return o}},4659:function(t,e,n){var r=n(3724),a=n(4913),o=n(6980);t.exports=function(t,e,n){r?a.f(t,e,o(0,n)):t[e]=n}},6279:function(t,e,n){var r=n(6840);t.exports=function(t,e,n){for(var a in e)r(t,a,e[a],n);return t}},6319:function(t,e,n){var r=n(8551),a=n(9539);t.exports=function(t,e,n,o){try{return o?e(r(n)[0],n[1]):e(n)}catch(i){a(t,"throw",i)}}},6801:function(t,e,n){var r=n(3724),a=n(8686),o=n(4913),i=n(8551),l=n(5397),u=n(1072);e.f=r&&!a?Object.defineProperties:function(t,e){i(t);var n,r=l(e),a=u(e),c=a.length,s=0;while(c>s)o.f(t,n=a[s++],r[n]);return t}},7657:function(t,e,n){var r,a,o,i=n(9039),l=n(4901),u=n(34),c=n(2360),s=n(2787),h=n(6840),d=n(8227),f=n(6395),g=d("iterator"),p=!1;[].keys&&(o=[].keys(),"next"in o?(a=s(s(o)),a!==Object.prototype&&(r=a)):p=!0);var _=!u(r)||i(function(){var t={};return r[g].call(t)!==t});_?r={}:f&&(r=c(r)),l(r[g])||h(r,g,function(){return this}),t.exports={IteratorPrototype:r,BUGGY_SAFARI_ITERATORS:p}},7717:function(t,e,n){n.r(e),n.d(e,{default:function(){return _}});n(8111),n(1701);var r=n(1431),a=n(8548),o=n(163),i=n(7918),l=n(3510);const u={class:"orangehrm-workshift-page"},c={class:"orangehrm-page-header"},s={class:"orangehrm-page-actions"},h={class:"orangehrm-shift-name"},d={class:"time-display"};var f=(0,r.pM)({__name:"WorkShiftList",setup(t){const e=(0,r.KR)([]),n=(0,r.KR)(!1),f=(0,r.KR)(""),g=(0,r.KR)(!1),p=(0,r.KR)(!1),_=(0,r.KR)(),m=(0,r.KR)(""),v=(0,r.Kh)({ten_ca:"",gio_bat_dau:"",gio_ket_thuc:"",thoi_gian_nghi:0,mo_ta:"",trang_thai:"Kích hoạt"}),b=(t,e,n)=>{if(!v.gio_bat_dau||!v.gio_ket_thuc)return void n();const[r,a]=v.gio_bat_dau.split(":").map(Number),[o,i]=v.gio_ket_thuc.split(":").map(Number),l=60*r+a,u=60*o+i;u<=l?n(new Error("Giờ kết thúc phải sau giờ bắt đầu")):n()},y={ten_ca:[{required:!0,message:"Vui lòng nhập tên ca làm việc",trigger:"blur"}],gio_bat_dau:[{required:!0,message:"Vui lòng chọn giờ bắt đầu",trigger:"change"}],gio_ket_thuc:[{required:!0,message:"Vui lòng chọn giờ kết thúc",trigger:"change"},{validator:b,trigger:"change"}],thoi_gian_nghi:[{type:"number",min:0,message:"Thời gian nghỉ phải lớn hơn hoặc bằng 0",trigger:"blur"}]},k=(t,e,n=0)=>{if(!t||!e)return"-";const[r,a]=t.split(":").map(Number),[o,i]=e.split(":").map(Number),l=60*r+a,u=60*o+i;if(u<=l)return"-";const c=u-l-(n||0),s=Math.floor(c/60),h=c%60;return 0===h?`${s} giờ`:`${s} giờ ${h} phút`},w=()=>{_.value&&v.gio_bat_dau&&v.gio_ket_thuc&&_.value.validateField("gio_ket_thuc")},x=async()=>{n.value=!0,f.value="";try{const t=await l.A.getAll();e.value=t.data||[]}catch(t){console.error("Error loading work shifts:",t),f.value=t.response?.data?.msg||"Không thể tải danh sách ca làm việc",o.nk.error(f.value)}finally{n.value=!1}},F=t=>{m.value=t._id,v.ten_ca=t.ten_ca,v.gio_bat_dau=t.gio_bat_dau,v.gio_ket_thuc=t.gio_ket_thuc,v.thoi_gian_nghi=t.thoi_gian_nghi||0,v.mo_ta=t.mo_ta||"",v.trang_thai=t.trang_thai,p.value=!0},I=async()=>{_.value&&await _.value.validate(async t=>{if(t){g.value=!0;try{m.value?(await l.A.update(m.value,v),o.nk.success("Cập nhật ca làm việc thành công")):(await l.A.create(v),o.nk.success("Thêm ca làm việc thành công")),R(),await x()}catch(e){console.error("Error saving work shift:",e),o.nk.error(e.response?.data?.msg||"Không thể lưu ca làm việc")}finally{g.value=!1}}})},A=async t=>{try{await i.s.confirm("Bạn có chắc chắn muốn xóa ca làm việc này?","Xác nhận xóa",{confirmButtonText:"Xóa",cancelButtonText:"Hủy",type:"warning"}),await l.A.delete(t),o.nk.success("Xóa ca làm việc thành công"),await x()}catch(e){"cancel"!==e&&(console.error("Error deleting work shift:",e),o.nk.error(e.response?.data?.msg||"Không thể xóa ca làm việc"))}},R=()=>{p.value=!1,m.value="",V()},V=()=>{_.value&&_.value.resetFields(),v.ten_ca="",v.gio_bat_dau="",v.gio_ket_thuc="",v.thoi_gian_nghi=0,v.mo_ta="",v.trang_thai="Kích hoạt"},T=t=>{if(!t)return"-";const e=new Date(t);return e.toLocaleDateString("vi-VN")};return(0,r.sV)(()=>{x()}),(t,o)=>{const i=(0,r.g2)("el-button"),l=(0,r.g2)("el-table-column"),b=(0,r.g2)("el-icon"),V=(0,r.g2)("el-tag"),C=(0,r.g2)("el-space"),S=(0,r.g2)("el-table"),H=(0,r.g2)("el-card"),E=(0,r.g2)("el-input"),K=(0,r.g2)("el-form-item"),W=(0,r.g2)("el-time-picker"),L=(0,r.g2)("el-input-number"),O=(0,r.g2)("el-radio"),U=(0,r.g2)("el-radio-group"),j=(0,r.g2)("el-form"),P=(0,r.g2)("el-dialog"),B=(0,r.gN)("loading");return(0,r.uX)(),(0,r.CE)("div",u,[(0,r.Lk)("div",c,[o[10]||(o[10]=(0,r.Lk)("h1",{class:"orangehrm-page-title"},"Ca làm việc",-1)),(0,r.Lk)("div",s,[(0,r.bF)(i,{icon:(0,r.R1)(a.Refresh),onClick:x},{default:(0,r.k6)(()=>[...o[8]||(o[8]=[(0,r.eW)("Tải lại",-1)])]),_:1},8,["icon"]),(0,r.bF)(i,{type:"primary",icon:(0,r.R1)(a.Plus),onClick:o[0]||(o[0]=t=>p.value=!0)},{default:(0,r.k6)(()=>[...o[9]||(o[9]=[(0,r.eW)(" Thêm ca làm việc ",-1)])]),_:1},8,["icon"])])]),(0,r.bF)(H,{class:"orangehrm-table-card",shadow:"never"},{default:(0,r.k6)(()=>[(0,r.bo)(((0,r.uX)(),(0,r.Wv)(S,{data:e.value,style:{width:"100%"},stripe:"","empty-text":f.value||"Không có dữ liệu"},{default:(0,r.k6)(()=>[(0,r.bF)(l,{prop:"ten_ca",label:"Tên ca","min-width":"200"},{default:(0,r.k6)(({row:t})=>[(0,r.Lk)("strong",h,(0,r.v_)(t.ten_ca),1)]),_:1}),(0,r.bF)(l,{label:"Thời gian","min-width":"250"},{default:(0,r.k6)(({row:t})=>[(0,r.Lk)("div",d,[(0,r.bF)(b,null,{default:(0,r.k6)(()=>[(0,r.bF)((0,r.R1)(a.Clock))]),_:1}),(0,r.Lk)("span",null,(0,r.v_)(t.gio_bat_dau)+" - "+(0,r.v_)(t.gio_ket_thuc),1),(0,r.bF)(V,{size:"small",type:"info"},{default:(0,r.k6)(()=>[(0,r.eW)((0,r.v_)(k(t.gio_bat_dau,t.gio_ket_thuc,t.thoi_gian_nghi)),1)]),_:2},1024)])]),_:1}),(0,r.bF)(l,{label:"Thời gian nghỉ",width:"150"},{default:(0,r.k6)(({row:t})=>[(0,r.eW)((0,r.v_)(t.thoi_gian_nghi||0)+" phút ",1)]),_:1}),(0,r.bF)(l,{prop:"mo_ta",label:"Mô tả","min-width":"250"},{default:(0,r.k6)(({row:t})=>[(0,r.eW)((0,r.v_)(t.mo_ta||"-"),1)]),_:1}),(0,r.bF)(l,{label:"Trạng thái",width:"150"},{default:(0,r.k6)(({row:t})=>[(0,r.bF)(V,{type:"Kích hoạt"===t.trang_thai?"success":"info"},{default:(0,r.k6)(()=>[(0,r.eW)((0,r.v_)(t.trang_thai),1)]),_:2},1032,["type"])]),_:1}),(0,r.bF)(l,{label:"Ngày tạo",width:"150"},{default:(0,r.k6)(({row:t})=>[(0,r.eW)((0,r.v_)(T(t.ngay_tao)),1)]),_:1}),(0,r.bF)(l,{label:"Hành động",width:"150",fixed:"right"},{default:(0,r.k6)(({row:t})=>[(0,r.bF)(C,null,{default:(0,r.k6)(()=>[(0,r.bF)(i,{size:"small",icon:(0,r.R1)(a.Edit),onClick:e=>F(t)},{default:(0,r.k6)(()=>[...o[11]||(o[11]=[(0,r.eW)(" Sửa ",-1)])]),_:1},8,["icon","onClick"]),(0,r.bF)(i,{size:"small",type:"danger",icon:(0,r.R1)(a.Delete),onClick:e=>A(t._id)},{default:(0,r.k6)(()=>[...o[12]||(o[12]=[(0,r.eW)(" Xóa ",-1)])]),_:1},8,["icon","onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data","empty-text"])),[[B,n.value]])]),_:1}),(0,r.bF)(P,{modelValue:p.value,"onUpdate:modelValue":o[7]||(o[7]=t=>p.value=t),title:m.value?"Chỉnh sửa ca làm việc":"Thêm ca làm việc mới",width:"600px","close-on-click-modal":!1},{footer:(0,r.k6)(()=>[(0,r.bF)(i,{onClick:R},{default:(0,r.k6)(()=>[...o[16]||(o[16]=[(0,r.eW)("Hủy",-1)])]),_:1}),(0,r.bF)(i,{type:"primary",loading:g.value,onClick:I},{default:(0,r.k6)(()=>[...o[17]||(o[17]=[(0,r.eW)(" Lưu ",-1)])]),_:1},8,["loading"])]),default:(0,r.k6)(()=>[(0,r.bF)(j,{ref_key:"formRef",ref:_,model:v,rules:y,"label-width":"140px","label-position":"left"},{default:(0,r.k6)(()=>[(0,r.bF)(K,{label:"Tên ca",prop:"ten_ca",required:""},{default:(0,r.k6)(()=>[(0,r.bF)(E,{modelValue:v.ten_ca,"onUpdate:modelValue":o[1]||(o[1]=t=>v.ten_ca=t),placeholder:"Ví dụ: Ca sáng, Ca chiều, Ca đêm"},null,8,["modelValue"])]),_:1}),(0,r.bF)(K,{label:"Giờ bắt đầu",prop:"gio_bat_dau",required:""},{default:(0,r.k6)(()=>[(0,r.bF)(W,{modelValue:v.gio_bat_dau,"onUpdate:modelValue":o[2]||(o[2]=t=>v.gio_bat_dau=t),format:"HH:mm","value-format":"HH:mm",placeholder:"Chọn giờ bắt đầu",style:{width:"100%"},onChange:w},null,8,["modelValue"])]),_:1}),(0,r.bF)(K,{label:"Giờ kết thúc",prop:"gio_ket_thuc",required:""},{default:(0,r.k6)(()=>[(0,r.bF)(W,{modelValue:v.gio_ket_thuc,"onUpdate:modelValue":o[3]||(o[3]=t=>v.gio_ket_thuc=t),format:"HH:mm","value-format":"HH:mm",placeholder:"Chọn giờ kết thúc",style:{width:"100%"},onChange:w},null,8,["modelValue"])]),_:1}),(0,r.bF)(K,{label:"Thời gian nghỉ",prop:"thoi_gian_nghi"},{default:(0,r.k6)(()=>[(0,r.bF)(L,{modelValue:v.thoi_gian_nghi,"onUpdate:modelValue":o[4]||(o[4]=t=>v.thoi_gian_nghi=t),min:0,max:480,placeholder:"0",style:{width:"100%"}},null,8,["modelValue"]),o[13]||(o[13]=(0,r.Lk)("span",{class:"form-hint"},"Đơn vị: phút",-1))]),_:1}),(0,r.bF)(K,{label:"Tổng giờ làm việc"},{default:(0,r.k6)(()=>[(0,r.bF)(V,{type:"success",size:"large"},{default:(0,r.k6)(()=>[(0,r.eW)((0,r.v_)(k(v.gio_bat_dau,v.gio_ket_thuc,v.thoi_gian_nghi)),1)]),_:1})]),_:1}),(0,r.bF)(K,{label:"Trạng thái",prop:"trang_thai"},{default:(0,r.k6)(()=>[(0,r.bF)(U,{modelValue:v.trang_thai,"onUpdate:modelValue":o[5]||(o[5]=t=>v.trang_thai=t)},{default:(0,r.k6)(()=>[(0,r.bF)(O,{label:"Kích hoạt"},{default:(0,r.k6)(()=>[...o[14]||(o[14]=[(0,r.eW)("Kích hoạt",-1)])]),_:1}),(0,r.bF)(O,{label:"Không kích hoạt"},{default:(0,r.k6)(()=>[...o[15]||(o[15]=[(0,r.eW)("Không kích hoạt",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),(0,r.bF)(K,{label:"Mô tả",prop:"mo_ta"},{default:(0,r.k6)(()=>[(0,r.bF)(E,{modelValue:v.mo_ta,"onUpdate:modelValue":o[6]||(o[6]=t=>v.mo_ta=t),type:"textarea",rows:4,placeholder:"Mô tả chi tiết về ca làm việc này..."},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}}),g=n(6262);const p=(0,g.A)(f,[["__scopeId","data-v-7cb26820"]]);var _=p},8111:function(t,e,n){var r=n(6518),a=n(4576),o=n(679),i=n(8551),l=n(4901),u=n(2787),c=n(2106),s=n(4659),h=n(9039),d=n(9297),f=n(8227),g=n(7657).IteratorPrototype,p=n(3724),_=n(6395),m="constructor",v="Iterator",b=f("toStringTag"),y=TypeError,k=a[v],w=_||!l(k)||k.prototype!==g||!h(function(){k({})}),x=function(){if(o(this,g),u(this)===g)throw new y("Abstract class Iterator not directly constructable")},F=function(t,e){p?c(g,t,{configurable:!0,get:function(){return e},set:function(e){if(i(this),this===g)throw new y("You can't redefine this property");d(this,t)?this[t]=e:s(this,t,e)}}):g[t]=e};d(g,b)||F(b,v),!w&&d(g,m)&&g[m]!==Object||F(m,x),x.prototype=g,r({global:!0,constructor:!0,forced:w},{Iterator:x})},9462:function(t,e,n){var r=n(9565),a=n(2360),o=n(6699),i=n(6279),l=n(8227),u=n(1181),c=n(5966),s=n(7657).IteratorPrototype,h=n(2529),d=n(9539),f=n(1385),g=l("toStringTag"),p="IteratorHelper",_="WrapForValidIterator",m="normal",v="throw",b=u.set,y=function(t){var e=u.getterFor(t?_:p);return i(a(s),{next:function(){var n=e(this);if(t)return n.nextHandler();if(n.done)return h(void 0,!0);try{var r=n.nextHandler();return n.returnHandlerResult?r:h(r,n.done)}catch(a){throw n.done=!0,a}},return:function(){var n=e(this),a=n.iterator;if(n.done=!0,t){var o=c(a,"return");return o?r(o,a):h(void 0,!0)}if(n.inner)try{d(n.inner.iterator,m)}catch(i){return d(a,v,i)}if(n.openIters)try{f(n.openIters,m)}catch(i){return d(a,v,i)}return a&&d(a,m),h(void 0,!0)}})},k=y(!0),w=y(!1);o(w,g,"Iterator Helper"),t.exports=function(t,e,n){var r=function(r,a){a?(a.iterator=r.iterator,a.next=r.next):a=r,a.type=e?_:p,a.returnHandlerResult=!!n,a.nextHandler=t,a.counter=0,a.done=!1,b(this,a)};return r.prototype=e?k:w,r}},9539:function(t,e,n){var r=n(9565),a=n(8551),o=n(5966);t.exports=function(t,e,n){var i,l;a(t);try{if(i=o(t,"return"),!i){if("throw"===e)throw n;return n}i=r(i,t)}catch(u){l=!0,i=u}if("throw"===e)throw n;if(l)throw i;return a(i),n}}}]);
//# sourceMappingURL=7717.7f97edfb.js.map