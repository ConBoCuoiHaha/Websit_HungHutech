"use strict";(self["webpackChunkHungHutech"]=self["webpackChunkHungHutech"]||[]).push([[3625],{116:function(e,n,t){var a=t(6518),r=t(9565),l=t(2652),i=t(9306),o=t(8551),u=t(1767),s=t(9539),c=t(4549),h=c("find",TypeError);a({target:"Iterator",proto:!0,real:!0,forced:h},{find:function(e){o(this);try{i(e)}catch(a){s(this,"throw",a)}if(h)return r(h,this,e);var n=u(this),t=0;return l(n,function(n,a){if(e(n,t++))return a(n)},{IS_RECORD:!0,INTERRUPTED:!0}).result}})},684:function(e){e.exports=function(e,n){var t="function"==typeof Iterator&&Iterator.prototype[e];if(t)try{t.call({next:null},n).next()}catch(a){return!0}}},1385:function(e,n,t){var a=t(9539);e.exports=function(e,n,t){for(var r=e.length-1;r>=0;r--)if(void 0!==e[r])try{t=a(e[r].iterator,n,t)}catch(l){n="throw",t=l}if("throw"===n)throw t;return t}},1526:function(e,n,t){var a=t(1114),r=t(4335);const l=window?.appGlobal?.baseUrl&&`${window.appGlobal.baseUrl}/api`,i=l||"http://192.168.88.50:5000/api";console.log("API Base URL:",i);class o{constructor(){(0,a.A)(this,"axiosInstance",void 0),this.axiosInstance=r.A.create({baseURL:i,headers:{"Content-Type":"application/json"}}),this.axiosInstance.interceptors.request.use(e=>{const n=localStorage.getItem("token");return n&&(e.headers.Authorization=`Bearer ${n}`),e},e=>Promise.reject(e)),this.axiosInstance.interceptors.response.use(e=>e,e=>(401===e.response?.status&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login"),Promise.reject(e)))}get(e,n){return this.axiosInstance.get(e,n)}post(e,n,t){return this.axiosInstance.post(e,n,t)}put(e,n,t){return this.axiosInstance.put(e,n,t)}delete(e,n){return this.axiosInstance.delete(e,n)}patch(e,n,t){return this.axiosInstance.patch(e,n,t)}}n.A=new o},1701:function(e,n,t){var a=t(6518),r=t(9565),l=t(9306),i=t(8551),o=t(1767),u=t(9462),s=t(6319),c=t(9539),h=t(684),d=t(4549),g=t(6395),_=!g&&!h("map",function(){}),p=!g&&!_&&d("map",TypeError),y=g||_||p,v=u(function(){var e=this.iterator,n=i(r(this.next,e)),t=this.done=!!n.done;if(!t)return s(e,this.mapper,[n.value,this.counter++],!0)});a({target:"Iterator",proto:!0,real:!0,forced:y},{map:function(e){i(this);try{l(e)}catch(n){c(this,"throw",n)}return p?r(p,this,e):new v(o(this),{mapper:e})}})},2529:function(e){e.exports=function(e,n){return{value:e,done:n}}},3625:function(e,n,t){t.r(n),t.d(n,{default:function(){return m}});t(4114),t(8111),t(116);var a=t(1431),r=t(8548),l=t(163),i=t(7918),o=t(6834),u=t(8303),s=t(6604);const c={class:"orangehrm-entitlement-page"},h={class:"orangehrm-page-header"},d={class:"orangehrm-page-actions"},g={class:"orangehrm-employee-info"},_={class:"orangehrm-employee-code"},p={class:"orangehrm-pagination"};var y=(0,a.pM)({__name:"LeaveEntitlementList",setup(e){const n=(0,a.KR)([]),t=(0,a.KR)([]),y=(0,a.KR)([]),v=(0,a.KR)(!1),f=(0,a.KR)(""),m=(0,a.KR)(!1),b=(0,a.KR)(!1),w=(0,a.KR)(""),k=(0,a.KR)(),A=(0,a.KR)(""),F=(0,a.KR)((new Date).getFullYear()),x=(0,a.KR)([]);for(let a=-2;a<=2;a++)x.value.push((new Date).getFullYear()+a);const R=(0,a.Kh)({currentPage:1,limit:10,total:0}),E=(0,a.Kh)({nhan_vien_id:"",loai_ngay_nghi_id:"",nam:(new Date).getFullYear(),so_ngay_duoc_huong:12,ghi_chu:""}),I={nhan_vien_id:[{required:!0,message:"Vui lòng chọn nhân viên",trigger:"change"}],loai_ngay_nghi_id:[{required:!0,message:"Vui lòng chọn loại nghỉ phép",trigger:"change"}],nam:[{required:!0,message:"Vui lòng chọn năm",trigger:"change"}],so_ngay_duoc_huong:[{required:!0,message:"Vui lòng nhập số ngày",trigger:"blur"}]},U=async()=>{v.value=!0,f.value="";try{const e=await o.A.getAll({page:R.currentPage,limit:R.limit,nhan_vien_id:A.value||void 0,nam:F.value});n.value=e.data||[],R.total=e.pagination?.total||0}catch(e){console.error("Error loading entitlements:",e),f.value=e.response?.data?.msg||"Không thể tải danh sách quyền nghỉ phép",l.nk.error(f.value)}finally{v.value=!1}},C=async()=>{try{const e=await u.A.getAll({limit:100});t.value=e.data||[]}catch(e){console.error("Error loading leave types:",e)}},L=async()=>{try{const e=await s.A.getAll({limit:1e3});y.value=e.data||[]}catch(e){console.error("Error loading employees:",e)}},$=e=>{R.currentPage=e,U()},V=e=>{R.limit=e,R.currentPage=1,U()},S=e=>{w.value=e._id,E.nhan_vien_id="string"===typeof e.nhan_vien_id?e.nhan_vien_id:e.nhan_vien_id._id,E.loai_ngay_nghi_id="string"===typeof e.loai_ngay_nghi_id?e.loai_ngay_nghi_id:e.loai_ngay_nghi_id._id,E.nam=e.nam,E.so_ngay_duoc_huong=e.so_ngay_duoc_huong,E.ghi_chu=e.ghi_chu||"",b.value=!0},B=async()=>{k.value&&await k.value.validate(async e=>{if(e){m.value=!0;try{w.value?(await o.A.update(w.value,E),l.nk.success("Cập nhật quyền nghỉ phép thành công")):(await o.A.create(E),l.nk.success("Thêm quyền nghỉ phép thành công")),q(),await U()}catch(n){console.error("Error saving entitlement:",n),l.nk.error(n.response?.data?.msg||"Không thể lưu quyền nghỉ phép")}finally{m.value=!1}}})},K=async e=>{try{await i.s.confirm("Bạn có chắc chắn muốn xóa quyền nghỉ phép này?","Xác nhận xóa",{confirmButtonText:"Xóa",cancelButtonText:"Hủy",type:"warning"}),await o.A.delete(e),l.nk.success("Xóa quyền nghỉ phép thành công"),await U()}catch(n){"cancel"!==n&&(console.error("Error deleting entitlement:",n),l.nk.error(n.response?.data?.msg||"Không thể xóa quyền nghỉ phép"))}},q=()=>{b.value=!1,w.value="",k.value&&k.value.resetFields(),E.nhan_vien_id="",E.loai_ngay_nghi_id="",E.nam=(new Date).getFullYear(),E.so_ngay_duoc_huong=12,E.ghi_chu=""},T=e=>{if("object"===typeof e&&e)return`${e.ho_dem} ${e.ten}`;const n=y.value.find(n=>n._id===e);return n?`${n.ho_dem} ${n.ten}`:"-"},W=e=>{if("object"===typeof e&&e)return e.ma_nhan_vien;const n=y.value.find(n=>n._id===e);return n?n.ma_nhan_vien:"-"},P=e=>{if("object"===typeof e&&e)return e.ten;const n=t.value.find(n=>n._id===e);return n?n.ten:"-"};return(0,a.sV)(()=>{U(),C(),L()}),(e,l)=>{const i=(0,a.g2)("el-button"),o=(0,a.g2)("el-option"),u=(0,a.g2)("el-select"),s=(0,a.g2)("el-form-item"),C=(0,a.g2)("el-form"),L=(0,a.g2)("el-card"),X=(0,a.g2)("el-table-column"),H=(0,a.g2)("el-tag"),N=(0,a.g2)("el-space"),j=(0,a.g2)("el-table"),z=(0,a.g2)("el-pagination"),D=(0,a.g2)("el-input-number"),O=(0,a.g2)("el-input"),G=(0,a.g2)("el-dialog"),Y=(0,a.gN)("loading");return(0,a.uX)(),(0,a.CE)("div",c,[(0,a.Lk)("div",h,[l[13]||(l[13]=(0,a.Lk)("h1",{class:"orangehrm-page-title"},"Quyền nghỉ phép",-1)),(0,a.Lk)("div",d,[(0,a.bF)(i,{icon:(0,a.R1)(r.Refresh),onClick:U},{default:(0,a.k6)(()=>[...l[11]||(l[11]=[(0,a.eW)("Tải lại",-1)])]),_:1},8,["icon"]),(0,a.bF)(i,{type:"primary",icon:(0,a.R1)(r.Plus),onClick:l[0]||(l[0]=e=>b.value=!0)},{default:(0,a.k6)(()=>[...l[12]||(l[12]=[(0,a.eW)(" Thêm quyền nghỉ phép ",-1)])]),_:1},8,["icon"])])]),(0,a.bF)(L,{class:"orangehrm-filter-card",shadow:"never"},{default:(0,a.k6)(()=>[(0,a.bF)(C,{inline:!0},{default:(0,a.k6)(()=>[(0,a.bF)(s,{label:"Nhân viên"},{default:(0,a.k6)(()=>[(0,a.bF)(u,{modelValue:A.value,"onUpdate:modelValue":l[1]||(l[1]=e=>A.value=e),placeholder:"Chọn nhân viên",filterable:"",clearable:"",style:{width:"300px"},onChange:U},{default:(0,a.k6)(()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(y.value,e=>((0,a.uX)(),(0,a.Wv)(o,{key:e._id,label:`${e.ho_dem} ${e.ten} (${e.ma_nhan_vien})`,value:e._id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,a.bF)(s,{label:"Năm"},{default:(0,a.k6)(()=>[(0,a.bF)(u,{modelValue:F.value,"onUpdate:modelValue":l[2]||(l[2]=e=>F.value=e),placeholder:"Chọn năm",style:{width:"150px"},onChange:U},{default:(0,a.k6)(()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(x.value,e=>((0,a.uX)(),(0,a.Wv)(o,{key:e,label:`Năm ${e}`,value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),(0,a.bF)(L,{class:"orangehrm-table-card",shadow:"never"},{default:(0,a.k6)(()=>[(0,a.bo)(((0,a.uX)(),(0,a.Wv)(j,{data:n.value,style:{width:"100%"},stripe:"","empty-text":f.value||"Không có dữ liệu"},{default:(0,a.k6)(()=>[(0,a.bF)(X,{type:"index",label:"STT",width:"60"}),(0,a.bF)(X,{label:"Nhân viên","min-width":"200"},{default:(0,a.k6)(({row:e})=>[(0,a.Lk)("div",g,[(0,a.Lk)("strong",null,(0,a.v_)(T(e.nhan_vien_id)),1),(0,a.Lk)("span",_,(0,a.v_)(W(e.nhan_vien_id)),1)])]),_:1}),(0,a.bF)(X,{label:"Loại nghỉ phép",width:"180"},{default:(0,a.k6)(({row:e})=>[(0,a.bF)(H,{type:"info",size:"small"},{default:(0,a.k6)(()=>[(0,a.eW)((0,a.v_)(P(e.loai_ngay_nghi_id)),1)]),_:2},1024)]),_:1}),(0,a.bF)(X,{label:"Năm",width:"100"},{default:(0,a.k6)(({row:e})=>[(0,a.Lk)("strong",null,(0,a.v_)(e.nam),1)]),_:1}),(0,a.bF)(X,{label:"Được hưởng",width:"130"},{default:(0,a.k6)(({row:e})=>[(0,a.bF)(H,{type:"primary"},{default:(0,a.k6)(()=>[(0,a.eW)((0,a.v_)(e.so_ngay_duoc_huong)+" ngày",1)]),_:2},1024)]),_:1}),(0,a.bF)(X,{label:"Đã dùng",width:"130"},{default:(0,a.k6)(({row:e})=>[(0,a.bF)(H,{type:"warning"},{default:(0,a.k6)(()=>[(0,a.eW)((0,a.v_)(e.so_ngay_da_su_dung)+" ngày",1)]),_:2},1024)]),_:1}),(0,a.bF)(X,{label:"Còn lại",width:"130"},{default:(0,a.k6)(({row:e})=>[(0,a.bF)(H,{type:"success"},{default:(0,a.k6)(()=>[(0,a.eW)((0,a.v_)(e.so_ngay_duoc_huong-e.so_ngay_da_su_dung)+" ngày ",1)]),_:2},1024)]),_:1}),(0,a.bF)(X,{label:"Ghi chú","min-width":"200"},{default:(0,a.k6)(({row:e})=>[(0,a.eW)((0,a.v_)(e.ghi_chu||"-"),1)]),_:1}),(0,a.bF)(X,{label:"Hành động",width:"200",fixed:"right"},{default:(0,a.k6)(({row:e})=>[(0,a.bF)(N,null,{default:(0,a.k6)(()=>[(0,a.bF)(i,{size:"small",icon:(0,a.R1)(r.Edit),onClick:n=>S(e)},{default:(0,a.k6)(()=>[...l[14]||(l[14]=[(0,a.eW)(" Sửa ",-1)])]),_:1},8,["icon","onClick"]),(0,a.bF)(i,{size:"small",type:"danger",icon:(0,a.R1)(r.Delete),onClick:n=>K(e._id)},{default:(0,a.k6)(()=>[...l[15]||(l[15]=[(0,a.eW)(" Xóa ",-1)])]),_:1},8,["icon","onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data","empty-text"])),[[Y,v.value]]),(0,a.Lk)("div",p,[(0,a.bF)(z,{"current-page":R.currentPage,"onUpdate:currentPage":l[3]||(l[3]=e=>R.currentPage=e),"page-size":R.limit,"onUpdate:pageSize":l[4]||(l[4]=e=>R.limit=e),"page-sizes":[10,20,50,100],total:R.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:V,onCurrentChange:$},null,8,["current-page","page-size","total"])])]),_:1}),(0,a.bF)(G,{modelValue:b.value,"onUpdate:modelValue":l[10]||(l[10]=e=>b.value=e),title:w.value?"Chỉnh sửa quyền nghỉ phép":"Thêm quyền nghỉ phép mới",width:"600px","close-on-click-modal":!1},{footer:(0,a.k6)(()=>[(0,a.bF)(i,{onClick:q},{default:(0,a.k6)(()=>[...l[16]||(l[16]=[(0,a.eW)("Hủy",-1)])]),_:1}),(0,a.bF)(i,{type:"primary",loading:m.value,onClick:B},{default:(0,a.k6)(()=>[(0,a.eW)((0,a.v_)(w.value?"Cập nhật":"Thêm mới"),1)]),_:1},8,["loading"])]),default:(0,a.k6)(()=>[(0,a.bF)(C,{ref_key:"formRef",ref:k,model:E,rules:I,"label-width":"180px","label-position":"left"},{default:(0,a.k6)(()=>[(0,a.bF)(s,{label:"Nhân viên",prop:"nhan_vien_id",required:""},{default:(0,a.k6)(()=>[(0,a.bF)(u,{modelValue:E.nhan_vien_id,"onUpdate:modelValue":l[5]||(l[5]=e=>E.nhan_vien_id=e),placeholder:"Chọn nhân viên",filterable:"",style:{width:"100%"}},{default:(0,a.k6)(()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(y.value,e=>((0,a.uX)(),(0,a.Wv)(o,{key:e._id,label:`${e.ho_dem} ${e.ten} (${e.ma_nhan_vien})`,value:e._id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,a.bF)(s,{label:"Loại nghỉ phép",prop:"loai_ngay_nghi_id",required:""},{default:(0,a.k6)(()=>[(0,a.bF)(u,{modelValue:E.loai_ngay_nghi_id,"onUpdate:modelValue":l[6]||(l[6]=e=>E.loai_ngay_nghi_id=e),placeholder:"Chọn loại nghỉ phép",style:{width:"100%"}},{default:(0,a.k6)(()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.value,e=>((0,a.uX)(),(0,a.Wv)(o,{key:e._id,label:e.ten,value:e._id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,a.bF)(s,{label:"Năm",prop:"nam",required:""},{default:(0,a.k6)(()=>[(0,a.bF)(u,{modelValue:E.nam,"onUpdate:modelValue":l[7]||(l[7]=e=>E.nam=e),placeholder:"Chọn năm",style:{width:"100%"}},{default:(0,a.k6)(()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(x.value,e=>((0,a.uX)(),(0,a.Wv)(o,{key:e,label:`Năm ${e}`,value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,a.bF)(s,{label:"Số ngày được hưởng",prop:"so_ngay_duoc_huong",required:""},{default:(0,a.k6)(()=>[(0,a.bF)(D,{modelValue:E.so_ngay_duoc_huong,"onUpdate:modelValue":l[8]||(l[8]=e=>E.so_ngay_duoc_huong=e),min:0,max:365,step:.5,precision:1,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),(0,a.bF)(s,{label:"Ghi chú",prop:"ghi_chu"},{default:(0,a.k6)(()=>[(0,a.bF)(O,{modelValue:E.ghi_chu,"onUpdate:modelValue":l[9]||(l[9]=e=>E.ghi_chu=e),type:"textarea",rows:3,placeholder:"Nhập ghi chú..."},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}}),v=t(6262);const f=(0,v.A)(y,[["__scopeId","data-v-37666a74"]]);var m=f},4114:function(e,n,t){var a=t(6518),r=t(8981),l=t(6198),i=t(4527),o=t(6837),u=t(9039),s=u(function(){return 4294967297!==[].push.call({length:4294967296},1)}),c=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(e){return e instanceof TypeError}},h=s||!c();a({target:"Array",proto:!0,arity:1,forced:h},{push:function(e){var n=r(this),t=l(n),a=arguments.length;o(t+a);for(var u=0;u<a;u++)n[t]=arguments[u],t++;return i(n,t),t}})},4376:function(e,n,t){var a=t(2195);e.exports=Array.isArray||function(e){return"Array"===a(e)}},4527:function(e,n,t){var a=t(3724),r=t(4376),l=TypeError,i=Object.getOwnPropertyDescriptor,o=a&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}();e.exports=o?function(e,n){if(r(e)&&!i(e,"length").writable)throw new l("Cannot set read only .length");return e.length=n}:function(e,n){return e.length=n}},6279:function(e,n,t){var a=t(6840);e.exports=function(e,n,t){for(var r in n)a(e,r,n[r],t);return e}},6319:function(e,n,t){var a=t(8551),r=t(9539);e.exports=function(e,n,t,l){try{return l?n(a(t)[0],t[1]):n(t)}catch(i){r(e,"throw",i)}}},6604:function(e,n,t){var a=t(1114),r=t(1526);class l{constructor(){(0,a.A)(this,"BASE_URL","/nhanvien")}async getAll(e){const n=await r.A.get(this.BASE_URL,{params:e});return n.data}async getById(e){const n=await r.A.get(`${this.BASE_URL}/${e}`);return n.data}async create(e){const n=await r.A.post(this.BASE_URL,e);return n.data}async update(e,n){const t=await r.A.put(`${this.BASE_URL}/${e}`,n);return t.data}async delete(e){await r.A.delete(`${this.BASE_URL}/${e}`)}}n.A=new l},6834:function(e,n,t){var a=t(1114),r=(t(8111),t(1701),t(1526));class l{constructor(){(0,a.A)(this,"BASE_URL","/quyennghiphep")}async getAll(e){const n=await r.A.get(this.BASE_URL,{params:e});return n.data}async getById(e){const n=await r.A.get(`${this.BASE_URL}/${e}`);return n.data}async getByNhanVienId(e,n){const t=await r.A.get(this.BASE_URL,{params:{nhan_vien_id:e,nam:n,limit:1e3}}),a=t.data.data||[];return a.map(e=>({loai_ngay_nghi:e.loai_ngay_nghi_id||{ten:"",mo_ta:""},so_ngay_duoc_huong:e.so_ngay_duoc_huong||0,so_ngay_da_su_dung:e.so_ngay_da_su_dung||0,so_ngay_con_lai:(e.so_ngay_duoc_huong||0)-(e.so_ngay_da_su_dung||0)}))}async create(e){const n=await r.A.post(this.BASE_URL,e);return n.data}async update(e,n){const t=await r.A.put(`${this.BASE_URL}/${e}`,n);return t.data}async delete(e){await r.A.delete(`${this.BASE_URL}/${e}`)}}n.A=new l},6837:function(e){var n=TypeError,t=9007199254740991;e.exports=function(e){if(e>t)throw n("Maximum allowed index exceeded");return e}},8303:function(e,n,t){var a=t(1114),r=t(1526);class l{constructor(){(0,a.A)(this,"BASE_URL","/loaingaynghi")}async getAll(e){const n=await r.A.get(this.BASE_URL,{params:e});return n.data}async getById(e){const n=await r.A.get(`${this.BASE_URL}/${e}`);return n.data}async create(e){const n=await r.A.post(this.BASE_URL,e);return n.data}async update(e,n){const t=await r.A.put(`${this.BASE_URL}/${e}`,n);return t.data}async delete(e){await r.A.delete(`${this.BASE_URL}/${e}`)}}n.A=new l},9462:function(e,n,t){var a=t(9565),r=t(2360),l=t(6699),i=t(6279),o=t(8227),u=t(1181),s=t(5966),c=t(7657).IteratorPrototype,h=t(2529),d=t(9539),g=t(1385),_=o("toStringTag"),p="IteratorHelper",y="WrapForValidIterator",v="normal",f="throw",m=u.set,b=function(e){var n=u.getterFor(e?y:p);return i(r(c),{next:function(){var t=n(this);if(e)return t.nextHandler();if(t.done)return h(void 0,!0);try{var a=t.nextHandler();return t.returnHandlerResult?a:h(a,t.done)}catch(r){throw t.done=!0,r}},return:function(){var t=n(this),r=t.iterator;if(t.done=!0,e){var l=s(r,"return");return l?a(l,r):h(void 0,!0)}if(t.inner)try{d(t.inner.iterator,v)}catch(i){return d(r,f,i)}if(t.openIters)try{g(t.openIters,v)}catch(i){return d(r,f,i)}return r&&d(r,v),h(void 0,!0)}})},w=b(!0),k=b(!1);l(k,_,"Iterator Helper"),e.exports=function(e,n,t){var a=function(a,r){r?(r.iterator=a.iterator,r.next=a.next):r=a,r.type=n?y:p,r.returnHandlerResult=!!t,r.nextHandler=e,r.counter=0,r.done=!1,m(this,r)};return a.prototype=n?w:k,a}}}]);
//# sourceMappingURL=3625.6d7e7e3f.js.map