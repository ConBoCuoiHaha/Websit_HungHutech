"use strict";(self["webpackChunkHungHutech"]=self["webpackChunkHungHutech"]||[]).push([[3097],{1114:function(t,e,a){function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function l(t,e){if("object"!=n(t)||!t)return t;var a=t[Symbol.toPrimitive];if(void 0!==a){var l=a.call(t,e||"default");if("object"!=n(l))return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function o(t){var e=l(t,"string");return"symbol"==n(e)?e:e+""}function s(t,e,a){return(e=o(e))in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}a.d(e,{A:function(){return s}})},1526:function(t,e,a){var n=a(1114),l=a(4335);const o=window?.appGlobal?.baseUrl&&`${window.appGlobal.baseUrl}/api`,s=o||"http://192.168.88.50:5000/api";console.log("API Base URL:",s);class i{constructor(){(0,n.A)(this,"axiosInstance",void 0),this.axiosInstance=l.A.create({baseURL:s,headers:{"Content-Type":"application/json"}}),this.axiosInstance.interceptors.request.use(t=>{const e=localStorage.getItem("token");return e&&(t.headers.Authorization=`Bearer ${e}`),t},t=>Promise.reject(t)),this.axiosInstance.interceptors.response.use(t=>t,t=>(401===t.response?.status&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login"),Promise.reject(t)))}get(t,e){return this.axiosInstance.get(t,e)}post(t,e,a){return this.axiosInstance.post(t,e,a)}put(t,e,a){return this.axiosInstance.put(t,e,a)}delete(t,e){return this.axiosInstance.delete(t,e)}patch(t,e,a){return this.axiosInstance.patch(t,e,a)}}e.A=new i},3097:function(t,e,a){a.r(e),a.d(e,{default:function(){return H}});var n=a(1431),l=a(1114),o=a(1526);class s{constructor(){(0,l.A)(this,"BASE_URL","/sites")}async getAll(t){const e=await o.A.get(this.BASE_URL,{params:t});return e.data}async getById(t){const e=await o.A.get(`${this.BASE_URL}/${t}`);return e.data}async create(t){const e=await o.A.post(this.BASE_URL,t);return e.data}async update(t,e){const a=await o.A.put(`${this.BASE_URL}/${t}`,e);return a.data}async delete(t){await o.A.delete(`${this.BASE_URL}/${t}`)}async toggle(t){const e=await o.A.patch(`${this.BASE_URL}/${t}/toggle`);return e.data}async getNearby(t,e,a){const n=await o.A.get(`${this.BASE_URL}/nearby`,{params:{longitude:t,latitude:e,maxDistance:a}});return n.data}}var i=new s;const r={class:"sites-container"},u={class:"toolbar"},c={class:"search-box"},d={class:"table-container"},v={key:0,class:"sites-table"},m={class:"coordinates"},h={class:"radius-badge"},p={class:"actions-col"},g=["onClick"],k=["title","onClick"],b=["onClick"],L={key:1,class:"loading-state"},y={key:2,class:"empty-state"},f={class:"modal-header"},A={class:"form-group"},C={class:"form-group"},_={class:"form-row"},S={class:"form-group"},w={class:"form-group"},x={class:"form-group"},E=["disabled"],T={class:"form-group"},U={class:"form-text"},I={class:"form-group"},R={class:"checkbox-label"},B={class:"form-actions"},$=["disabled"];var V=(0,n.pM)({__name:"SitesManagement",setup(t){const e=(0,n.KR)([]),a=(0,n.KR)(""),l=(0,n.KR)(!1),o=(0,n.KR)(!1),s=(0,n.KR)(!1),V=(0,n.KR)(!1),q=(0,n.KR)(null),K=(0,n.KR)({name:"",address:"",longitude:106.7009,latitude:10.7756,radius:150,isActive:!0});async function H(){try{l.value=!0;const t=await i.getAll({q:a.value,limit:100});e.value=t.data}catch(t){console.error("Error loading sites:",t),alert("âŒ Lá»—i khi táº£i danh sÃ¡ch Ä‘á»‹a Ä‘iá»ƒm: "+(t.response?.data?.msg||t.message))}finally{l.value=!1}}function P(){H()}function X(){q.value=null,K.value={name:"",address:"",longitude:106.7009,latitude:10.7756,radius:150,isActive:!0},V.value=!0}function D(t){q.value=t._id,K.value={name:t.name,address:t.address,longitude:t.longitude,latitude:t.latitude,radius:t.radius,isActive:t.isActive},V.value=!0}function Q(){V.value=!1,q.value=null}async function j(){try{o.value=!0,q.value?(await i.update(q.value,K.value),alert("âœ… Cáº­p nháº­t thÃ nh cÃ´ng!")):(await i.create(K.value),alert("âœ… ThÃªm Ä‘á»‹a Ä‘iá»ƒm thÃ nh cÃ´ng!")),Q(),H()}catch(t){console.error("Error saving site:",t),alert("âŒ Lá»—i: "+(t.response?.data?.msg||t.message))}finally{o.value=!1}}async function G(t){const e=t.isActive?"táº¯t":"báº­t";if(confirm(`Báº¡n cÃ³ cháº¯c muá»‘n ${e} Ä‘á»‹a Ä‘iá»ƒm "${t.name}"?`))try{await i.toggle(t._id),alert(`âœ… ÄÃ£ ${e} Ä‘á»‹a Ä‘iá»ƒm thÃ nh cÃ´ng!`),H()}catch(a){console.error("Error toggling site:",a),alert("âŒ Lá»—i khi cáº­p nháº­t tráº¡ng thÃ¡i: "+(a.response?.data?.msg||a.message))}}async function J(t){if(confirm(`âš ï¸ XÃ³a Ä‘á»‹a Ä‘iá»ƒm "${t.name}"?\n\nThao tÃ¡c nÃ y khÃ´ng thá»ƒ hoÃ n tÃ¡c!`))try{await i.delete(t._id),alert("âœ… XÃ³a thÃ nh cÃ´ng!"),H()}catch(e){console.error("Error deleting site:",e),alert("âŒ Lá»—i khi xÃ³a: "+(e.response?.data?.msg||e.message))}}function N(){navigator.geolocation?(s.value=!0,navigator.geolocation.getCurrentPosition(t=>{K.value.latitude=t.coords.latitude,K.value.longitude=t.coords.longitude,s.value=!1,alert("âœ… ÄÃ£ láº¥y vá»‹ trÃ­ hiá»‡n táº¡i!\n\nLat: "+t.coords.latitude.toFixed(6)+"\nLng: "+t.coords.longitude.toFixed(6))},t=>{s.value=!1,console.error("Geolocation error:",t),alert("âŒ KhÃ´ng thá»ƒ láº¥y vá»‹ trÃ­:\n"+t.message+"\n\nVui lÃ²ng:\n1. Báº­t GPS\n2. Cho phÃ©p trÃ¬nh duyá»‡t truy cáº­p vá»‹ trÃ­\n3. Sá»­ dá»¥ng HTTPS")},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})):alert("âŒ TrÃ¬nh duyá»‡t khÃ´ng há»— trá»£ Geolocation")}function F(t){return t?new Date(t).toLocaleDateString("vi-VN"):"-"}return(0,n.sV)(()=>{H()}),(t,i)=>((0,n.uX)(),(0,n.CE)("div",r,[i[18]||(i[18]=(0,n.Lk)("div",{class:"page-header"},[(0,n.Lk)("h1",null,"ðŸ“ Quáº£n lÃ½ Äá»‹a Ä‘iá»ƒm Cháº¥m cÃ´ng"),(0,n.Lk)("p",{class:"subtitle"}," Quáº£n lÃ½ cÃ¡c Ä‘á»‹a Ä‘iá»ƒm cho phÃ©p nhÃ¢n viÃªn cháº¥m cÃ´ng qua á»©ng dá»¥ng di Ä‘á»™ng ")],-1)),(0,n.Lk)("div",u,[(0,n.Lk)("div",c,[(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":i[0]||(i[0]=t=>a.value=t),placeholder:"ðŸ” TÃ¬m kiáº¿m theo tÃªn, Ä‘á»‹a chá»‰, mÃ£...",class:"search-input",onInput:P},null,544),[[n.Jo,a.value]])]),(0,n.Lk)("button",{class:"btn-primary",onClick:X}," âž• ThÃªm Ä‘á»‹a Ä‘iá»ƒm ")]),(0,n.Lk)("div",d,[!l.value&&e.value.length>0?((0,n.uX)(),(0,n.CE)("table",v,[i[8]||(i[8]=(0,n.Lk)("thead",null,[(0,n.Lk)("tr",null,[(0,n.Lk)("th",null,"MÃ£"),(0,n.Lk)("th",null,"TÃªn Ä‘á»‹a Ä‘iá»ƒm"),(0,n.Lk)("th",null,"Äá»‹a chá»‰"),(0,n.Lk)("th",null,"Tá»a Ä‘á»™ (Lat, Lng)"),(0,n.Lk)("th",null,"BÃ¡n kÃ­nh"),(0,n.Lk)("th",null,"Tráº¡ng thÃ¡i"),(0,n.Lk)("th",null,"NgÃ y táº¡o"),(0,n.Lk)("th",{class:"actions-col"},"Thao tÃ¡c")])],-1)),(0,n.Lk)("tbody",null,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.value,t=>((0,n.uX)(),(0,n.CE)("tr",{key:t._id},[(0,n.Lk)("td",null,[(0,n.Lk)("strong",null,(0,n.v_)(t.siteId),1)]),(0,n.Lk)("td",null,(0,n.v_)(t.name),1),(0,n.Lk)("td",null,(0,n.v_)(t.address),1),(0,n.Lk)("td",m,[(0,n.Lk)("span",null,(0,n.v_)(t.latitude?.toFixed(6))+", "+(0,n.v_)(t.longitude?.toFixed(6)),1)]),(0,n.Lk)("td",null,[(0,n.Lk)("span",h,(0,n.v_)(t.radius)+"m",1)]),(0,n.Lk)("td",null,[(0,n.Lk)("span",{class:(0,n.C4)(t.isActive?"status-active":"status-inactive")},(0,n.v_)(t.isActive?"ðŸŸ¢ Hoáº¡t Ä‘á»™ng":"ðŸ”´ Táº¯t"),3)]),(0,n.Lk)("td",null,(0,n.v_)(F(t.createdAt)),1),(0,n.Lk)("td",p,[(0,n.Lk)("button",{class:"btn-action btn-edit",title:"Sá»­a",onClick:e=>D(t)}," âœï¸ ",8,g),(0,n.Lk)("button",{class:"btn-action btn-toggle",title:t.isActive?"Táº¯t":"Báº­t",onClick:e=>G(t)},(0,n.v_)(t.isActive?"ðŸ”´":"ðŸŸ¢"),9,k),(0,n.Lk)("button",{class:"btn-action btn-delete",title:"XÃ³a",onClick:e=>J(t)}," ðŸ—‘ï¸ ",8,b)])]))),128))])])):(0,n.Q3)("",!0),l.value?((0,n.uX)(),(0,n.CE)("div",L,[...i[9]||(i[9]=[(0,n.Lk)("div",{class:"spinner"},null,-1),(0,n.Lk)("p",null,"Äang táº£i dá»¯ liá»‡u...",-1)])])):(0,n.Q3)("",!0),l.value||0!==e.value.length?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.CE)("div",y,[i[10]||(i[10]=(0,n.Lk)("p",null,"ðŸ“­ ChÆ°a cÃ³ Ä‘á»‹a Ä‘iá»ƒm nÃ o",-1)),(0,n.Lk)("button",{class:"btn-primary",onClick:X}," ThÃªm Ä‘á»‹a Ä‘iá»ƒm Ä‘áº§u tiÃªn ")]))]),V.value?((0,n.uX)(),(0,n.CE)("div",{key:0,class:"modal-overlay",onClick:Q},[(0,n.Lk)("div",{class:"modal-content",onClick:i[7]||(i[7]=(0,n.D$)(()=>{},["stop"]))},[(0,n.Lk)("div",f,[(0,n.Lk)("h2",null,(0,n.v_)(q.value?"âœï¸ Sá»­a":"âž• ThÃªm")+" Äá»‹a Ä‘iá»ƒm",1),(0,n.Lk)("button",{class:"btn-close",onClick:Q},"âœ–")]),(0,n.Lk)("form",{class:"modal-body",onSubmit:(0,n.D$)(j,["prevent"])},[(0,n.Lk)("div",A,[i[11]||(i[11]=(0,n.Lk)("label",{class:"form-label required"},"TÃªn Ä‘á»‹a Ä‘iá»ƒm",-1)),(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":i[1]||(i[1]=t=>K.value.name=t),type:"text",class:"form-control",placeholder:"VD: VÄƒn phÃ²ng chÃ­nh - Q1",required:""},null,512),[[n.Jo,K.value.name]])]),(0,n.Lk)("div",C,[i[12]||(i[12]=(0,n.Lk)("label",{class:"form-label required"},"Äá»‹a chá»‰",-1)),(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":i[2]||(i[2]=t=>K.value.address=t),type:"text",class:"form-control",placeholder:"VD: 208 Nguyá»…n Há»¯u Cáº£nh, BÃ¬nh Tháº¡nh, TP.HCM",required:""},null,512),[[n.Jo,K.value.address]])]),(0,n.Lk)("div",_,[(0,n.Lk)("div",S,[i[13]||(i[13]=(0,n.Lk)("label",{class:"form-label required"},"VÄ© Ä‘á»™ (Latitude)",-1)),(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":i[3]||(i[3]=t=>K.value.latitude=t),type:"number",step:"any",class:"form-control",placeholder:"VD: 10.7756",required:""},null,512),[[n.Jo,K.value.latitude,void 0,{number:!0}]])]),(0,n.Lk)("div",w,[i[14]||(i[14]=(0,n.Lk)("label",{class:"form-label required"},"Kinh Ä‘á»™ (Longitude)",-1)),(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":i[4]||(i[4]=t=>K.value.longitude=t),type:"number",step:"any",class:"form-control",placeholder:"VD: 106.7009",required:""},null,512),[[n.Jo,K.value.longitude,void 0,{number:!0}]])])]),(0,n.Lk)("div",x,[(0,n.Lk)("button",{type:"button",class:"btn-secondary",disabled:s.value,onClick:N},(0,n.v_)(s.value?"â³ Äang láº¥y...":"ðŸ“ Láº¥y vá»‹ trÃ­ hiá»‡n táº¡i"),9,E),i[15]||(i[15]=(0,n.Lk)("small",{class:"form-text"},"Sá»­ dá»¥ng GPS cá»§a trÃ¬nh duyá»‡t Ä‘á»ƒ láº¥y tá»a Ä‘á»™ hiá»‡n táº¡i",-1))]),(0,n.Lk)("div",T,[i[16]||(i[16]=(0,n.Lk)("label",{class:"form-label required"},"BÃ¡n kÃ­nh cho phÃ©p (m)",-1)),(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":i[5]||(i[5]=t=>K.value.radius=t),type:"number",min:"10",max:"1000",class:"form-control",required:""},null,512),[[n.Jo,K.value.radius,void 0,{number:!0}]]),(0,n.Lk)("small",U,"NhÃ¢n viÃªn cáº§n á»Ÿ trong bÃ¡n kÃ­nh "+(0,n.v_)(K.value.radius)+"m Ä‘á»ƒ cháº¥m cÃ´ng",1)]),(0,n.Lk)("div",I,[(0,n.Lk)("label",R,[(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":i[6]||(i[6]=t=>K.value.isActive=t),type:"checkbox"},null,512),[[n.lH,K.value.isActive]]),i[17]||(i[17]=(0,n.Lk)("span",null,"KÃ­ch hoáº¡t Ä‘á»‹a Ä‘iá»ƒm",-1))])]),(0,n.Lk)("div",B,[(0,n.Lk)("button",{type:"button",class:"btn-cancel",onClick:Q}," Há»§y "),(0,n.Lk)("button",{type:"submit",class:"btn-save",disabled:o.value},(0,n.v_)(o.value?"â³ Äang lÆ°u...":"ðŸ’¾ LÆ°u"),9,$)])],32)])])):(0,n.Q3)("",!0)]))}}),q=a(6262);const K=(0,q.A)(V,[["__scopeId","data-v-6fdd117d"]]);var H=K},6262:function(t,e){e.A=(t,e)=>{const a=t.__vccOpts||t;for(const[n,l]of e)a[n]=l;return a}}}]);
//# sourceMappingURL=3097.5aa8c300.js.map