"use strict";(self["webpackChunkHungHutech"]=self["webpackChunkHungHutech"]||[]).push([[4806],{1114:function(e,a,t){function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function l(e,a){if("object"!=n(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var l=t.call(e,a||"default");if("object"!=n(l))return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===a?String:Number)(e)}function o(e){var a=l(e,"string");return"symbol"==n(a)?a:a+""}function i(e,a,t){return(a=o(a))in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}t.d(a,{A:function(){return i}})},1526:function(e,a,t){var n=t(1114),l=t(4335);const o=window?.appGlobal?.baseUrl&&`${window.appGlobal.baseUrl}/api`,i=o||"http://192.168.88.50:5000/api";console.log("API Base URL:",i);class r{constructor(){(0,n.A)(this,"axiosInstance",void 0),this.axiosInstance=l.A.create({baseURL:i,headers:{"Content-Type":"application/json"}}),this.axiosInstance.interceptors.request.use(e=>{const a=localStorage.getItem("token");return a&&(e.headers.Authorization=`Bearer ${a}`),e},e=>Promise.reject(e)),this.axiosInstance.interceptors.response.use(e=>e,e=>(401===e.response?.status&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login"),Promise.reject(e)))}get(e,a){return this.axiosInstance.get(e,a)}post(e,a,t){return this.axiosInstance.post(e,a,t)}put(e,a,t){return this.axiosInstance.put(e,a,t)}delete(e,a){return this.axiosInstance.delete(e,a)}patch(e,a,t){return this.axiosInstance.patch(e,a,t)}}a.A=new r},3510:function(e,a,t){var n=t(1114),l=t(1526);class o{constructor(){(0,n.A)(this,"BASE_URL","/calamviec")}async getAll(e){const a=await l.A.get(this.BASE_URL,{params:e});return a.data}async getById(e){const a=await l.A.get(`${this.BASE_URL}/${e}`);return a.data}async create(e){const a=await l.A.post(this.BASE_URL,e);return a.data}async update(e,a){const t=await l.A.put(`${this.BASE_URL}/${e}`,a);return t.data}async delete(e){await l.A.delete(`${this.BASE_URL}/${e}`)}}a.A=new o},4114:function(e,a,t){var n=t(6518),l=t(8981),o=t(6198),i=t(4527),r=t(6837),c=t(9039),u=c(function(){return 4294967297!==[].push.call({length:4294967296},1)}),d=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(e){return e instanceof TypeError}},s=u||!d();n({target:"Array",proto:!0,arity:1,forced:s},{push:function(e){var a=l(this),t=o(a),n=arguments.length;r(t+n);for(var c=0;c<n;c++)a[t]=arguments[c],t++;return i(a,t),t}})},4376:function(e,a,t){var n=t(2195);e.exports=Array.isArray||function(e){return"Array"===n(e)}},4527:function(e,a,t){var n=t(3724),l=t(4376),o=TypeError,i=Object.getOwnPropertyDescriptor,r=n&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}();e.exports=r?function(e,a){if(l(e)&&!i(e,"length").writable)throw new o("Cannot set read only .length");return e.length=a}:function(e,a){return e.length=a}},4806:function(e,a,t){t.r(a),t.d(a,{default:function(){return k}});t(4114);var n=t(1431),l=t(5220),o=t(8548),i=t(163),r=t(7918),c=t(6604),u=t(5086),d=t(3510);const s={class:"orangehrm-employee-page"},h={class:"orangehrm-page-header"},_={class:"orangehrm-page-actions"},m={class:"orangehrm-employee-id"},p={class:"orangehrm-employee-name"},g={class:"orangehrm-name-primary"},v={key:0,class:"orangehrm-name-nickname"},b={class:"orangehrm-pagination"};var f=(0,n.pM)({__name:"NhanVienList",setup(e){const a=(0,l.rd)(),t=(0,n.KR)([]),f=(0,n.KR)(!1),y=(0,n.KR)(""),w=(0,n.KR)(!1),k=(0,n.KR)(!1),F=(0,n.KR)(),A=(0,n.KR)(""),V=(0,n.KR)(""),R=(0,n.KR)(""),U=(0,n.Kh)({currentPage:1,limit:10,total:0}),x=(0,n.KR)([]),E=(0,n.Kh)({ma_nhan_vien:"",ho_dem:"",ten:"",biet_danh:"",lien_he:{email_cong_viec:"",di_dong:""},thong_tin_cong_viec:{ca_lam_viec_id:""}}),S={ma_nhan_vien:[{required:!0,message:"Vui lòng nhập mã nhân viên",trigger:"blur"}],ho_dem:[{required:!0,message:"Vui lòng nhập họ đệm",trigger:"blur"}],ten:[{required:!0,message:"Vui lòng nhập tên",trigger:"blur"}]},L=async()=>{f.value=!0,y.value="";try{const e=await c.A.getAll({page:U.currentPage,limit:U.limit,q:A.value});t.value=e.data||[],U.total=e.pagination?.total||0}catch(e){console.error("Error loading employees:",e),y.value=e.response?.data?.msg||"Không thể tải danh sách nhân viên",i.nk.error(y.value)}finally{f.value=!1}},C=async()=>{try{const e=await d.A.getAll({limit:100});x.value=e.data||e.items||[]}catch(e){console.error("Error loading work shifts:",e),i.nk.error(e.response?.data?.msg||"Không thể tải danh sách ca làm việc")}},$=()=>{U.currentPage=1,L()},B=e=>{U.currentPage=e,L()},P=e=>{U.limit=e,U.currentPage=1,L()},T=async()=>{F.value&&await F.value.validate(async e=>{if(e){w.value=!0;try{await c.A.create(E),i.nk.success("Thêm nhân viên thành công"),W(),await L()}catch(a){console.error("Error creating employee:",a),i.nk.error(a.response?.data?.msg||"Không thể tạo nhân viên")}finally{w.value=!1}}})},I=e=>{a.push(`/nhan-vien/${e}`)},K=async e=>{try{await r.s.confirm("Bạn có chắc chắn muốn xóa nhân viên này?","Xác nhận xóa",{confirmButtonText:"Xóa",cancelButtonText:"Hủy",type:"warning"}),await c.A.delete(e),i.nk.success("Xóa nhân viên thành công"),await L()}catch(a){"cancel"!==a&&(console.error("Error deleting employee:",a),i.nk.error(a.response?.data?.msg||"Không thể xóa nhân viên"))}},W=()=>{k.value=!1,j()},j=()=>{F.value&&F.value.resetFields(),E.ma_nhan_vien="",E.ho_dem="",E.ten="",E.biet_danh="",E.lien_he.email_cong_viec="",E.lien_he.di_dong="",E.thong_tin_cong_viec.ca_lam_viec_id=""};return(0,n.sV)(()=>{L(),C()}),(e,a)=>{const l=(0,n.g2)("el-button"),i=(0,n.g2)("el-input"),r=(0,n.g2)("el-col"),c=(0,n.g2)("el-option"),d=(0,n.g2)("el-select"),C=(0,n.g2)("el-row"),j=(0,n.g2)("el-card"),z=(0,n.g2)("el-icon"),N=(0,n.g2)("el-avatar"),X=(0,n.g2)("el-table-column"),H=(0,n.g2)("el-space"),q=(0,n.g2)("el-table"),O=(0,n.g2)("el-pagination"),D=(0,n.g2)("el-divider"),M=(0,n.g2)("el-form-item"),G=(0,n.g2)("el-form"),Q=(0,n.g2)("el-dialog"),J=(0,n.gN)("loading");return(0,n.uX)(),(0,n.CE)("div",s,[(0,n.Lk)("div",h,[a[16]||(a[16]=(0,n.Lk)("h1",{class:"orangehrm-page-title"},"Danh sách Nhân viên",-1)),(0,n.Lk)("div",_,[(0,n.bF)(l,{icon:(0,n.R1)(o.Refresh),onClick:L},{default:(0,n.k6)(()=>[...a[14]||(a[14]=[(0,n.eW)("Tải lại",-1)])]),_:1},8,["icon"]),(0,n.bF)(l,{type:"primary",icon:(0,n.R1)(o.Plus),onClick:a[0]||(a[0]=e=>k.value=!0)},{default:(0,n.k6)(()=>[...a[15]||(a[15]=[(0,n.eW)(" Thêm nhân viên ",-1)])]),_:1},8,["icon"])])]),(0,n.bF)(j,{class:"orangehrm-search-card",shadow:"never"},{default:(0,n.k6)(()=>[(0,n.bF)(C,{gutter:16},{default:(0,n.k6)(()=>[(0,n.bF)(r,{xs:24,sm:12,md:8},{default:(0,n.k6)(()=>[(0,n.bF)(i,{modelValue:A.value,"onUpdate:modelValue":a[1]||(a[1]=e=>A.value=e),placeholder:"Tìm kiếm theo tên, mã nhân viên...","prefix-icon":(0,n.R1)(o.Search),clearable:"",onInput:$},null,8,["modelValue","prefix-icon"])]),_:1}),(0,n.bF)(r,{xs:24,sm:12,md:8},{default:(0,n.k6)(()=>[(0,n.bF)(d,{modelValue:V.value,"onUpdate:modelValue":a[2]||(a[2]=e=>V.value=e),placeholder:"Lọc theo chức danh",clearable:"",style:{width:"100%"}},{default:(0,n.k6)(()=>[(0,n.bF)(c,{label:"Tất cả chức danh",value:""})]),_:1},8,["modelValue"])]),_:1}),(0,n.bF)(r,{xs:24,sm:12,md:8},{default:(0,n.k6)(()=>[(0,n.bF)(d,{modelValue:R.value,"onUpdate:modelValue":a[3]||(a[3]=e=>R.value=e),placeholder:"Lọc theo phòng ban",clearable:"",style:{width:"100%"}},{default:(0,n.k6)(()=>[(0,n.bF)(c,{label:"Tất cả phòng ban",value:""})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),(0,n.bF)(j,{class:"orangehrm-table-card",shadow:"never"},{default:(0,n.k6)(()=>[(0,n.bo)(((0,n.uX)(),(0,n.Wv)(q,{data:t.value,style:{width:"100%"},stripe:"","empty-text":y.value||"Không có dữ liệu"},{default:(0,n.k6)(()=>[(0,n.bF)(X,{label:"Ảnh",width:"80"},{default:(0,n.k6)(({row:e})=>[(0,n.bF)(N,{size:40,src:e.avatar_url?(0,n.R1)(u.A).getFileUrl(e.avatar_url):void 0},{default:(0,n.k6)(()=>[(0,n.bF)(z,null,{default:(0,n.k6)(()=>[(0,n.bF)((0,n.R1)(o.User))]),_:1})]),_:1},8,["src"])]),_:1}),(0,n.bF)(X,{prop:"ma_nhan_vien",label:"Mã NV","min-width":"120"},{default:(0,n.k6)(({row:e})=>[(0,n.Lk)("strong",m,(0,n.v_)(e.ma_nhan_vien),1)]),_:1}),(0,n.bF)(X,{label:"Họ và tên","min-width":"200"},{default:(0,n.k6)(({row:e})=>[(0,n.Lk)("div",p,[(0,n.Lk)("span",g,(0,n.v_)(e.ho_dem)+" "+(0,n.v_)(e.ten),1),e.biet_danh?((0,n.uX)(),(0,n.CE)("span",v," ("+(0,n.v_)(e.biet_danh)+") ",1)):(0,n.Q3)("",!0)])]),_:1}),(0,n.bF)(X,{label:"Email","min-width":"200"},{default:(0,n.k6)(({row:e})=>[(0,n.eW)((0,n.v_)(e.lien_he?.email_cong_viec||"-"),1)]),_:1}),(0,n.bF)(X,{label:"Số điện thoại","min-width":"150"},{default:(0,n.k6)(({row:e})=>[(0,n.eW)((0,n.v_)(e.lien_he?.di_dong||"-"),1)]),_:1}),(0,n.bF)(X,{label:"Chức danh","min-width":"150"},{default:(0,n.k6)(({row:e})=>[(0,n.eW)((0,n.v_)(e.thong_tin_cong_viec?.chuc_danh_id?.ten_chuc_danh||"-"),1)]),_:1}),(0,n.bF)(X,{label:"Phòng ban","min-width":"150"},{default:(0,n.k6)(({row:e})=>[(0,n.eW)((0,n.v_)(e.thong_tin_cong_viec?.phong_ban_id?.ten||"-"),1)]),_:1}),(0,n.bF)(X,{label:"Ca làm việc","min-width":"160"},{default:(0,n.k6)(({row:e})=>[(0,n.eW)((0,n.v_)(e.thong_tin_cong_viec?.ca_lam_viec_id?.ten_ca||"-"),1)]),_:1}),(0,n.bF)(X,{label:"Hành động",width:"180",fixed:"right"},{default:(0,n.k6)(({row:e})=>[(0,n.bF)(H,null,{default:(0,n.k6)(()=>[(0,n.bF)(l,{size:"small",icon:(0,n.R1)(o.View),onClick:a=>I(e._id)},{default:(0,n.k6)(()=>[...a[17]||(a[17]=[(0,n.eW)(" Xem ",-1)])]),_:1},8,["icon","onClick"]),(0,n.bF)(l,{size:"small",type:"danger",icon:(0,n.R1)(o.Delete),onClick:a=>K(e._id)},{default:(0,n.k6)(()=>[...a[18]||(a[18]=[(0,n.eW)(" Xóa ",-1)])]),_:1},8,["icon","onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data","empty-text"])),[[J,f.value]]),(0,n.Lk)("div",b,[(0,n.bF)(O,{"current-page":U.currentPage,"onUpdate:currentPage":a[4]||(a[4]=e=>U.currentPage=e),"page-size":U.limit,"onUpdate:pageSize":a[5]||(a[5]=e=>U.limit=e),"page-sizes":[10,20,50,100],total:U.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:P,onCurrentChange:B},null,8,["current-page","page-size","total"])])]),_:1}),(0,n.bF)(Q,{modelValue:k.value,"onUpdate:modelValue":a[13]||(a[13]=e=>k.value=e),title:"Thêm nhân viên mới",width:"600px","close-on-click-modal":!1},{footer:(0,n.k6)(()=>[(0,n.bF)(l,{onClick:W},{default:(0,n.k6)(()=>[...a[22]||(a[22]=[(0,n.eW)("Hủy",-1)])]),_:1}),(0,n.bF)(l,{type:"primary",loading:w.value,onClick:T},{default:(0,n.k6)(()=>[...a[23]||(a[23]=[(0,n.eW)(" Lưu ",-1)])]),_:1},8,["loading"])]),default:(0,n.k6)(()=>[(0,n.bF)(G,{ref_key:"createFormRef",ref:F,model:E,rules:S,"label-width":"140px","label-position":"left"},{default:(0,n.k6)(()=>[(0,n.bF)(D,{"content-position":"left"},{default:(0,n.k6)(()=>[...a[19]||(a[19]=[(0,n.eW)("Thông tin cơ bản",-1)])]),_:1}),(0,n.bF)(M,{label:"Mã nhân viên",prop:"ma_nhan_vien",required:""},{default:(0,n.k6)(()=>[(0,n.bF)(i,{modelValue:E.ma_nhan_vien,"onUpdate:modelValue":a[6]||(a[6]=e=>E.ma_nhan_vien=e),placeholder:"Nhập mã nhân viên"},null,8,["modelValue"])]),_:1}),(0,n.bF)(M,{label:"Họ đệm",prop:"ho_dem",required:""},{default:(0,n.k6)(()=>[(0,n.bF)(i,{modelValue:E.ho_dem,"onUpdate:modelValue":a[7]||(a[7]=e=>E.ho_dem=e),placeholder:"Nhập họ đệm"},null,8,["modelValue"])]),_:1}),(0,n.bF)(M,{label:"Tên",prop:"ten",required:""},{default:(0,n.k6)(()=>[(0,n.bF)(i,{modelValue:E.ten,"onUpdate:modelValue":a[8]||(a[8]=e=>E.ten=e),placeholder:"Nhập tên"},null,8,["modelValue"])]),_:1}),(0,n.bF)(M,{label:"Biệt danh",prop:"biet_danh"},{default:(0,n.k6)(()=>[(0,n.bF)(i,{modelValue:E.biet_danh,"onUpdate:modelValue":a[9]||(a[9]=e=>E.biet_danh=e),placeholder:"Nhập biệt danh (nếu có)"},null,8,["modelValue"])]),_:1}),(0,n.bF)(D,{"content-position":"left"},{default:(0,n.k6)(()=>[...a[20]||(a[20]=[(0,n.eW)("Thông tin liên hệ",-1)])]),_:1}),(0,n.bF)(M,{label:"Email công việc",prop:"lien_he.email_cong_viec"},{default:(0,n.k6)(()=>[(0,n.bF)(i,{modelValue:E.lien_he.email_cong_viec,"onUpdate:modelValue":a[10]||(a[10]=e=>E.lien_he.email_cong_viec=e),type:"email",placeholder:"email@congty.com"},null,8,["modelValue"])]),_:1}),(0,n.bF)(M,{label:"Số điện thoại",prop:"lien_he.di_dong"},{default:(0,n.k6)(()=>[(0,n.bF)(i,{modelValue:E.lien_he.di_dong,"onUpdate:modelValue":a[11]||(a[11]=e=>E.lien_he.di_dong=e),placeholder:"Nhập số điện thoại"},null,8,["modelValue"])]),_:1}),(0,n.bF)(D,{"content-position":"left"},{default:(0,n.k6)(()=>[...a[21]||(a[21]=[(0,n.eW)("Thông tin công việc",-1)])]),_:1}),(0,n.bF)(M,{label:"Ca làm việc",prop:"thong_tin_cong_viec.ca_lam_viec_id"},{default:(0,n.k6)(()=>[(0,n.bF)(d,{modelValue:E.thong_tin_cong_viec.ca_lam_viec_id,"onUpdate:modelValue":a[12]||(a[12]=e=>E.thong_tin_cong_viec.ca_lam_viec_id=e),placeholder:"Chọn ca làm việc",clearable:"",filterable:"",style:{width:"100%"}},{default:(0,n.k6)(()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(x.value,e=>((0,n.uX)(),(0,n.Wv)(c,{key:e._id,label:`${e.ten_ca} (${e.gio_bat_dau} - ${e.gio_ket_thuc})`,value:e._id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}}),y=t(6262);const w=(0,y.A)(f,[["__scopeId","data-v-3f4148b0"]]);var k=w},5086:function(e,a,t){var n=t(1526);class l{async uploadEmployeePhoto(e,a){const t=new FormData;t.append("file",a);const l=await n.A.post(`/upload/nhanvien/${e}/photo`,t,{headers:{"Content-Type":"multipart/form-data"}});return l.data}async listFiles(e,a){const t=await n.A.get("/upload/files",{params:{owner_type:e,owner_id:a}});return t.data}async deleteFile(e){await n.A.delete(`/upload/files/${e}`)}getFileUrl(e){const a=e.replace(/^\/uploads\//,"").replace(/^uploads[\/\\]/,""),t="http://localhost:5000";return`${t}/uploads/${a}`}}a.A=new l},6604:function(e,a,t){var n=t(1114),l=t(1526);class o{constructor(){(0,n.A)(this,"BASE_URL","/nhanvien")}async getAll(e){const a=await l.A.get(this.BASE_URL,{params:e});return a.data}async getById(e){const a=await l.A.get(`${this.BASE_URL}/${e}`);return a.data}async create(e){const a=await l.A.post(this.BASE_URL,e);return a.data}async update(e,a){const t=await l.A.put(`${this.BASE_URL}/${e}`,a);return t.data}async delete(e){await l.A.delete(`${this.BASE_URL}/${e}`)}}a.A=new o},6837:function(e){var a=TypeError,t=9007199254740991;e.exports=function(e){if(e>t)throw a("Maximum allowed index exceeded");return e}}}]);
//# sourceMappingURL=4806.c82d3c55.js.map